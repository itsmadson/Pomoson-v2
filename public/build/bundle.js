var app=function(){"use strict";function e(){}function t(e){return e()}function s(){return Object.create(null)}function r(e){e.forEach(t)}function n(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,s,r){t.$$.on_destroy.push(function(t,...s){if(null==t){for(const e of s)e(void 0);return e}const r=t.subscribe(...s);return r.unsubscribe?()=>r.unsubscribe():r}(s,r))}const o="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;let l,c=!1;function h(e,t,s,r){for(;e<t;){const n=e+(t-e>>1);s(n)<=r?e=n+1:t=n}return e}function u(e,t){if(c){for(!function(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if("HEAD"===e.nodeName){const e=[];for(let s=0;s<t.length;s++){const r=t[s];void 0!==r.claim_order&&e.push(r)}t=e}const s=new Int32Array(t.length+1),r=new Int32Array(t.length);s[0]=-1;let n=0;for(let e=0;e<t.length;e++){const i=t[e].claim_order,a=(n>0&&t[s[n]].claim_order<=i?n+1:h(1,n,e=>t[s[e]].claim_order,i))-1;r[e]=s[a]+1;const o=a+1;s[o]=e,n=Math.max(o,n)}const i=[],a=[];let o=t.length-1;for(let e=s[n]+1;0!=e;e=r[e-1]){for(i.push(t[e-1]);o>=e;o--)a.push(t[o]);o--}for(;o>=0;o--)a.push(t[o]);i.reverse(),a.sort((e,t)=>e.claim_order-t.claim_order);for(let t=0,s=0;t<a.length;t++){for(;s<i.length&&a[t].claim_order>=i[s].claim_order;)s++;const r=s<i.length?i[s]:null;e.insertBefore(a[t],r)}}(e),(void 0===e.actual_end_child||null!==e.actual_end_child&&e.actual_end_child.parentNode!==e)&&(e.actual_end_child=e.firstChild);null!==e.actual_end_child&&void 0===e.actual_end_child.claim_order;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?void 0===t.claim_order&&t.parentNode===e||e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else t.parentNode===e&&null===t.nextSibling||e.appendChild(t)}function d(e,t,s){c&&!s?u(e,t):t.parentNode===e&&t.nextSibling==s||e.insertBefore(t,s||null)}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}function g(e){return document.createElement(e)}function v(e){return document.createTextNode(e)}function m(){return v(" ")}function y(){return v("")}function b(e,t,s,r){return e.addEventListener(t,s,r),()=>e.removeEventListener(t,s,r)}function w(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function k(e){return e.dataset.svelteH}function _(e){return""===e?null:+e}function T(e){return Array.from(e.childNodes)}function S(e,t,s,r,n=!1){!function(e){void 0===e.claim_info&&(e.claim_info={last_index:0,total_claimed:0})}(e);const i=(()=>{for(let r=e.claim_info.last_index;r<e.length;r++){const i=e[r];if(t(i)){const t=s(i);return void 0===t?e.splice(r,1):e[r]=t,n||(e.claim_info.last_index=r),i}}for(let r=e.claim_info.last_index-1;r>=0;r--){const i=e[r];if(t(i)){const t=s(i);return void 0===t?e.splice(r,1):e[r]=t,n?void 0===t&&e.claim_info.last_index--:e.claim_info.last_index=r,i}}return r()})();return i.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,i}function E(e,t,s){return function(e,t,s,r){return S(e,e=>e.nodeName===t,e=>{const t=[];for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];s[n.name]||t.push(n.name)}t.forEach(t=>e.removeAttribute(t))},()=>r(t))}(e,t,s,g)}function $(e,t){return S(e,e=>3===e.nodeType,e=>{const s=""+t;if(e.data.startsWith(s)){if(e.data.length!==s.length)return e.splitText(s.length)}else e.data=s},()=>v(t),!0)}function x(e){return $(e," ")}function j(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e,t){e.value=null==t?"":t}function I(e,t,s,r){null==s?e.style.removeProperty(t):e.style.setProperty(t,s,"")}function P(e,t,s){e.classList.toggle(t,!!s)}function O(e){l=e}function C(){if(!l)throw new Error("Function called outside component initialization");return l}function R(e){C().$$.on_mount.push(e)}function D(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach(e=>e.call(this,t))}const U=[],N=[];let L=[];const B=[],M=Promise.resolve();let q=!1;function V(e){L.push(e)}const J=new Set;let W=0;function z(){if(0!==W)return;const e=l;do{try{for(;W<U.length;){const e=U[W];W++,O(e),F(e.$$)}}catch(e){throw U.length=0,W=0,e}for(O(null),U.length=0,W=0;N.length;)N.pop()();for(let e=0;e<L.length;e+=1){const t=L[e];J.has(t)||(J.add(t),t())}L.length=0}while(U.length);for(;B.length;)B.pop()();q=!1,J.clear(),O(e)}function F(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(V)}}const H=new Set;let K;function G(){K={r:0,c:[],p:K}}function Y(){K.r||r(K.c),K=K.p}function X(e,t){e&&e.i&&(H.delete(e),e.i(t))}function Q(e,t,s,r){if(e&&e.o){if(H.has(e))return;H.add(e),K.c.push(()=>{H.delete(e),r&&(s&&e.d(1),r())}),e.o(t)}else r&&r()}function Z(e){return void 0!==e?.length?e:Array.from(e)}function ee(e,t){e.d(1),t.delete(e.key)}function te(e,t,s,n,i,a,o,l,c,h,u,d){let f=e.length,p=a.length,g=f;const v={};for(;g--;)v[e[g].key]=g;const m=[],y=new Map,b=new Map,w=[];for(g=p;g--;){const e=d(i,a,g),r=s(e);let n=o.get(r);n?w.push(()=>n.p(e,t)):(n=h(r,e),n.c()),y.set(r,m[g]=n),r in v&&b.set(r,Math.abs(g-v[r]))}const k=new Set,_=new Set;function T(e){X(e,1),e.m(l,u),o.set(e.key,e),u=e.first,p--}for(;f&&p;){const t=m[p-1],s=e[f-1],r=t.key,n=s.key;t===s?(u=t.first,f--,p--):y.has(n)?!o.has(r)||k.has(r)?T(t):_.has(n)?f--:b.get(r)>b.get(n)?(_.add(r),T(t)):(k.add(n),f--):(c(s,o),f--)}for(;f--;){const t=e[f];y.has(t.key)||c(t,o)}for(;p;)T(m[p-1]);return r(w),m}function se(e){e&&e.c()}function re(e,t){e&&e.l(t)}function ne(e,s,i){const{fragment:a,after_update:o}=e.$$;a&&a.m(s,i),V(()=>{const s=e.$$.on_mount.map(t).filter(n);e.$$.on_destroy?e.$$.on_destroy.push(...s):r(s),e.$$.on_mount=[]}),o.forEach(V)}function ie(e,t){const s=e.$$;null!==s.fragment&&(!function(e){const t=[],s=[];L.forEach(r=>-1===e.indexOf(r)?t.push(r):s.push(r)),s.forEach(e=>e()),L=t}(s.after_update),r(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function ae(e,t){-1===e.$$.dirty[0]&&(U.push(e),q||(q=!0,M.then(z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,n,i,a,o,h,u=null,d=[-1]){const p=l;O(t);const g=t.$$={fragment:null,ctx:[],props:h,update:e,not_equal:o,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(p?p.$$.context:[])),callbacks:s(),dirty:d,skip_bound:!1,root:n.target||p.$$.root};u&&u(g.root);let v=!1;if(g.ctx=i?i(t,n.props||{},(e,s,...r)=>{const n=r.length?r[0]:s;return g.ctx&&o(g.ctx[e],g.ctx[e]=n)&&(!g.skip_bound&&g.bound[e]&&g.bound[e](n),v&&ae(t,e)),s}):[],g.update(),v=!0,r(g.before_update),g.fragment=!!a&&a(g.ctx),n.target){if(n.hydrate){c=!0;const e=T(n.target);g.fragment&&g.fragment.l(e),e.forEach(f)}else g.fragment&&g.fragment.c();n.intro&&X(t.$$.fragment),ne(t,n.target,n.anchor),c=!1,z()}O(p)}class le{$$=void 0;$$set=void 0;$destroy(){ie(this,1),this.$destroy=e}$on(t,s){if(!n(s))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(s),()=>{const e=r.indexOf(s);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class ce extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class he extends ce{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ue extends ce{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class de extends ce{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var fe;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(fe||(fe={}));var pe=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};class ge{constructor(e,{headers:t={},customFetch:s,region:r=fe.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(function(){return Ie}).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return pe(this,void 0,void 0,function*(){try{const{headers:r,method:n,body:i}=t;let a,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",a=i):"string"==typeof i?(o["Content-Type"]="text/plain",a=i):"undefined"!=typeof FormData&&i instanceof FormData?a=i:(o["Content-Type"]="application/json",a=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:a}).catch(e=>{throw new he(e)}),h=c.headers.get("x-relay-error");if(h&&"true"===h)throw new ue(c);if(!c.ok)throw new de(c);let u,d=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"text/event-stream"===d?c:"multipart/form-data"===d?yield c.formData():yield c.text(),{data:u,error:null}}catch(e){return{data:null,error:e}}})}}var ve="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function me(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var s=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(s,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),s}var ye={},be={},we={},ke={},_e={},Te={},Se=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Ee=Se.fetch;var $e=Se.fetch.bind(Se);const xe=Se.Headers,je=Se.Request,Ae=Se.Response;var Ie=Object.freeze({__proto__:null,Headers:xe,Request:je,Response:Ae,default:$e,fetch:Ee}),Pe=me(Ie),Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});let Ce=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Oe.default=Ce;var Re=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Te,"__esModule",{value:!0});const De=Re(Pe),Ue=Re(Oe);Te.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=De.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,r;let n=null,i=null,a=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(a=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(n={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,a=null,o=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(i=[],n=null,o=200,l="OK")}catch(s){404===e.status&&""===t?(o=204,l="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(r=null==n?void 0:n.details)||void 0===r?void 0:r.includes("0 rows"))&&(n=null,o=200,l="OK"),n&&this.shouldThrowOnError)throw new Ue.default(n)}return{error:n,data:i,count:a,status:o,statusText:l}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var Ne=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0});const Le=Ne(Te);let Be=class extends Le.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const n=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:n=!1,format:i="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};_e.default=Be;var Me=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ke,"__esModule",{value:!0});const qe=Me(_e);let Ve=class extends qe.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let n="";"plain"===r?n="pl":"phrase"===r?n="ph":"websearch"===r&&(n="w");const i=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};ke.default=Ve;var Je=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(we,"__esModule",{value:!0});const We=Je(ke);we.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),new We.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new We.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){const i=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new We.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new We.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new We.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var ze={},Fe={};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.version=void 0,Fe.version="0.0.0-automated",Object.defineProperty(ze,"__esModule",{value:!0}),ze.DEFAULT_HEADERS=void 0;const He=Fe;ze.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${He.version}`};var Ke=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(be,"__esModule",{value:!0});const Ge=Ke(we),Ye=Ke(ke),Xe=ze;be.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Xe.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Ge.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:n}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let o;s||r?(i=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{a.searchParams.append(e,t)})):(i="POST",o=t);const l=Object.assign({},this.headers);return n&&(l.Prefer=`count=${n}`),new Ye.default({method:i,url:a,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var Qe=ve&&ve.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.PostgrestError=ye.PostgrestBuilder=ye.PostgrestTransformBuilder=ye.PostgrestFilterBuilder=ye.PostgrestQueryBuilder=ye.PostgrestClient=void 0;const Ze=Qe(be);ye.PostgrestClient=Ze.default;const et=Qe(we);ye.PostgrestQueryBuilder=et.default;const tt=Qe(ke);ye.PostgrestFilterBuilder=tt.default;const st=Qe(_e);ye.PostgrestTransformBuilder=st.default;const rt=Qe(Te);ye.PostgrestBuilder=rt.default;const nt=Qe(Oe);ye.PostgrestError=nt.default;var it=ye.default={PostgrestClient:Ze.default,PostgrestQueryBuilder:et.default,PostgrestFilterBuilder:tt.default,PostgrestTransformBuilder:st.default,PostgrestBuilder:rt.default,PostgrestError:nt.default};const{PostgrestClient:at,PostgrestQueryBuilder:ot,PostgrestFilterBuilder:lt,PostgrestTransformBuilder:ct,PostgrestBuilder:ht,PostgrestError:ut}=it;const dt=function(){if("undefined"!=typeof WebSocket)return WebSocket;if(void 0!==global.WebSocket)return global.WebSocket;if(void 0!==window.WebSocket)return window.WebSocket;if(void 0!==self.WebSocket)return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}();var ft,pt,gt,vt,mt,yt;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(ft||(ft={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(pt||(pt={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(gt||(gt={})),function(e){e.websocket="websocket"}(vt||(vt={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(mt||(mt={}));class bt{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),n=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=s.decode(e.slice(i,i+r));i+=r;const o=s.decode(e.slice(i,i+n));i+=n;return{ref:null,topic:a,event:o,payload:JSON.parse(s.decode(e.slice(i,e.byteLength)))}}}class wt{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(yt||(yt={}));const kt=(e,t,s={})=>{var r;const n=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((s,r)=>(s[r]=_t(r,e,t,n),s),{})},_t=(e,t,s,r)=>{const n=t.find(t=>t.name===e),i=null==n?void 0:n.type,a=s[e];return i&&!r.includes(i)?Tt(i,a):St(a)},Tt=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return jt(t,s)}switch(e){case yt.bool:return Et(t);case yt.float4:case yt.float8:case yt.int2:case yt.int4:case yt.int8:case yt.numeric:case yt.oid:return $t(t);case yt.json:case yt.jsonb:return xt(t);case yt.timestamp:return At(t);case yt.abstime:case yt.date:case yt.daterange:case yt.int4range:case yt.int8range:case yt.money:case yt.reltime:case yt.text:case yt.time:case yt.timestamptz:case yt.timetz:case yt.tsrange:case yt.tstzrange:default:return St(t)}},St=e=>e,Et=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},$t=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},xt=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},jt=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const n=e.slice(1,s);try{r=JSON.parse("["+n+"]")}catch(e){r=n?n.split(","):[]}return r.map(e=>Tt(t,e))}return e},At=e=>"string"==typeof e?e.replace(" ","T"):e,It=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Pt{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ot,Ct,Rt,Dt;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Ot||(Ot={}));class Ut{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ut.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=Ut.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],r()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Ut.syncDiff(this.state,e,t,s),r())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const n=this.cloneDeep(e),i=this.transformState(t),a={},o={};return this.map(n,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{const s=n[e];if(s){const r=t.map(e=>e.presence_ref),n=s.map(e=>e.presence_ref),i=t.filter(e=>n.indexOf(e.presence_ref)<0),l=s.filter(e=>r.indexOf(e.presence_ref)<0);i.length>0&&(a[e]=i),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(n,{joins:a,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(n,(t,r)=>{var n;const i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(r),i.length>0){const s=e[t].map(e=>e.presence_ref),r=i.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...r)}s(t,i,r)}),this.map(i,(t,s)=>{let n=e[t];if(!n)return;const i=s.map(e=>e.presence_ref);n=n.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=n,r(t,n,s),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Ct||(Ct={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(Rt||(Rt={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(Dt||(Dt={}));class Nt{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=pt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Pt(this,gt.join,this.params,this.timeout),this.rejoinTimer=new wt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=pt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=pt.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=pt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=pt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gt.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Ut(this),this.broadcastEndpointURL=It(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==pt.closed){const{config:{broadcast:n,presence:i,private:a}}=this.params;this._onError(t=>null==e?void 0:e(Dt.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Dt.CLOSED));const o={},l={broadcast:n,presence:i,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==r?r:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,n=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,i=[];for(let s=0;s<n;s++){const n=r[s],{filter:{event:a,schema:o,table:l,filter:c}}=n,h=t&&t[s];if(!h||h.event!==a||h.schema!==o||h.table!==l||h.filter!==c)return this.unsubscribe(),this.state=pt.errored,void(null==e||e(Dt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},n),{id:h.id}))}return this.bindings.postgres_changes=i,void(e&&e(Dt.SUBSCRIBED))}null==e||e(Dt.SUBSCRIBED)}).receive("error",t=>{this.state=pt.errored,null==e||e(Dt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Dt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var r,n,i;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||s("ok"),a.receive("ok",()=>s("ok")),a.receive("error",()=>s("error")),a.receive("timeout",()=>s("timed out"))});{const{event:n,payload:i}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){return"AbortError"===e.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=pt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gt.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Pt(this,gt.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const r=new AbortController,n=setTimeout(()=>r.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(n),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Pt(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,n;const i=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=gt;if(s&&[a,o,l,c].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===i}).map(e=>e.callback(h,s)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var s,r,n,a,o,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,a=null===(s=e.filter)||void 0===s?void 0:s.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const s=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof h&&"ids"in h){const e=h.data,{schema:t,table:s,commit_timestamp:r,type:n,errors:i}=e,a={schema:t,table:s,commit_timestamp:r,eventType:n,new:{},old:{},errors:i};h=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(h,s)})}_isClosed(){return this.state===pt.closed}_isJoined(){return this.state===pt.joined}_isJoining(){return this.state===pt.joining}_isLeaving(){return this.state===pt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),n={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(n):this.bindings[r]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Nt.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(gt.close,{},e)}_onError(e){this._on(gt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=pt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=kt(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=kt(e.columns,e.old_record)),t}}const Lt=()=>{};class Bt{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lt,this.ref=0,this.logger=Lt,this.conn=null,this.sendBuffer=[],this.serializer=new bt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(function(){return Ie}).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${vt.websocket}`,this.httpEndpoint=It(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new wt(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=dt),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ft.connecting:return mt.Connecting;case ft.open:return mt.Open;case ft.closing:return mt.Closing;default:return mt.Closed}}isConnected(){return this.connectionState()===mt.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===s);if(r)return r;{const s=new Nt(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:r,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${n})`,r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const s={access_token:t,version:"realtime-js/2.11.15"};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(gt.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:s,payload:r,ref:n}=e;"phoenix"===t&&"phx_reply"===s&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),n&&n===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${n&&"("+n+")"||""}`,r),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,r,n)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(gt.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Mt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function qt(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Vt extends Mt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Jt extends Mt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Wt=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};const zt=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(function(){return Ie}).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},Ft=e=>{if(Array.isArray(e))return e.map(e=>Ft(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,s])=>{const r=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=Ft(s)}),t};var Ht=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};const Kt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Gt=(e,t,s)=>Ht(void 0,void 0,void 0,function*(){const r=yield Wt(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(function(){return Ie})).Response:Response});e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{t(new Vt(Kt(s),e.status||500))}).catch(e=>{t(new Jt(Kt(e),e))}):t(new Jt(Kt(e),e))});function Yt(e,t,s,r,n,i){return Ht(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(s,((e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),s))})(t,r,n,i)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>Gt(e,o,r))})})}function Xt(e,t,s,r){return Ht(this,void 0,void 0,function*(){return Yt(e,"GET",t,s,r)})}function Qt(e,t,s,r,n){return Ht(this,void 0,void 0,function*(){return Yt(e,"POST",t,r,n,s)})}function Zt(e,t,s,r,n){return Ht(this,void 0,void 0,function*(){return Yt(e,"DELETE",t,r,n,s)})}var es=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};const ts={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ss={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rs{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=zt(r)}uploadOrUpdate(e,t,s,r){return es(this,void 0,void 0,function*(){try{let n;const i=Object.assign(Object.assign({},ss),r);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const o=i.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(n=s,n.append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o))):(n=s,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(a=Object.assign(Object.assign({},a),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:n,headers:a},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),u=yield h.json();if(h.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}upload(e,t,s){return es(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return es(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),i=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ss.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:i}),l=yield o.json();if(o.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return es(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const n=yield Qt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),i=new URL(this.url+n.url),a=i.searchParams.get("token");if(!a)throw new Mt("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}update(e,t,s){return es(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return es(this,void 0,void 0,function*(){try{return{data:yield Qt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}copy(e,t,s){return es(this,void 0,void 0,function*(){try{return{data:{path:(yield Qt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,s){return es(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=yield Qt(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,s){return es(this,void 0,void 0,function*(){try{const r=yield Qt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}download(e,t){return es(this,void 0,void 0,function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield Xt(this.fetch,`${this.url}/${s}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}info(e){return es(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Xt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ft(e),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}exists(e){return es(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return Ht(this,void 0,void 0,function*(){return Yt(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(qt(e)&&e instanceof Jt){const t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&r.push(n);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${o}`)}}}remove(e){return es(this,void 0,void 0,function*(){try{return{data:yield Zt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}list(e,t,s){return es(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},ts),t),{prefix:e||""});return{data:yield Qt(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ns={"X-Client-Info":"storage-js/2.7.1"};var is=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};class as{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},ns),t),this.fetch=zt(s)}listBuckets(){return is(this,void 0,void 0,function*(){try{return{data:yield Xt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}getBucket(e){return is(this,void 0,void 0,function*(){try{return{data:yield Xt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return is(this,void 0,void 0,function*(){try{return{data:yield Qt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return is(this,void 0,void 0,function*(){try{const s=yield function(e,t,s,r,n){return Ht(this,void 0,void 0,function*(){return Yt(e,"PUT",t,r,n,s)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}emptyBucket(e){return is(this,void 0,void 0,function*(){try{return{data:yield Qt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}deleteBucket(e){return is(this,void 0,void 0,function*(){try{return{data:yield Zt(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(qt(e))return{data:null,error:e};throw e}})}}class os extends as{constructor(e,t={},s){super(e,t,s)}from(e){return new rs(this.url,this.headers,e,this.fetch)}}let ls="";ls="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const cs={headers:{"X-Client-Info":`supabase-js-${ls}/2.50.2`}},hs={schema:"public"},us={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ds={};var fs=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};const ps=e=>{let t;return t=e||("undefined"==typeof fetch?$e:fetch),(...e)=>t(...e)},gs=(e,t,s)=>{const r=ps(s),n="undefined"==typeof Headers?xe:Headers;return(s,i)=>fs(void 0,void 0,void 0,function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},i),{headers:l}))})};var vs=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};const ms="2.70.0",ys=3e4,bs=9e4,ws={"X-Client-Info":`gotrue-js/${ms}`},ks="X-Supabase-Api-Version",_s={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ts=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Ss extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Es(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class $s extends Ss{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class xs extends Ss{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class js extends Ss{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class As extends js{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Is extends js{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ps extends js{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Os extends js{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Cs extends js{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rs extends js{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ds(e){return Es(e)&&"AuthRetryableFetchError"===e.name}class Us extends js{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Ns extends js{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Bs=" \t\n\r=".split(""),Ms=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Bs.length;t+=1)e[Bs[t].charCodeAt(0)]=-2;for(let t=0;t<Ls.length;t+=1)e[Ls[t].charCodeAt(0)]=t;return e})();function qs(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Ls[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(Ls[e]),t.queuedBits-=6}}function Vs(e,t,s){const r=Ms[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Js(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let t=0;t<e.length;t+=1)Vs(e.charCodeAt(t),n,i);return t.join("")}function Ws(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function zs(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)Vs(e.charCodeAt(t),s,r);return new Uint8Array(t)}function Fs(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Ws(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function Hs(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>qs(e,s,r)),qs(null,s,r),t.join("")}const Ks=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Gs={tested:!1,writable:!1},Ys=()=>{if(!Ks())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(Gs.tested)return Gs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Gs.tested=!0,Gs.writable=!0}catch(e){Gs.tested=!0,Gs.writable=!1}return Gs.writable};const Xs=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(function(){return Ie}).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},Qs=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Zs=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(e){return s}},er=async(e,t)=>{await e.removeItem(t)};class tr{constructor(){this.promise=new tr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function sr(e){const t=e.split(".");if(3!==t.length)throw new Ns("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!Ts.test(t[e]))throw new Ns("JWT not in base64url format");return{header:JSON.parse(Js(t[0])),payload:JSON.parse(Js(t[1])),signature:zs(t[2]),raw:{header:t[0],payload:t[1]}}}function rr(e){return("0"+e.toString(16)).substr(-2)}async function nr(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ir(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,rr).join("")}();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await Qs(e,`${t}-code-verifier`,n);const i=await nr(r);return[i,r===i?"plain":"s256"]}tr.promiseConstructor=Promise;const ar=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const or=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function lr(e){if(!or.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var cr=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s};const hr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ur=[502,503,504];async function dr(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new Rs(hr(e),0);if(ur.includes(e.status))throw new Rs(hr(e),e.status);let r,n;try{r=await e.json()}catch(e){throw new xs(hr(e),e)}const i=function(e){const t=e.headers.get(ks);if(!t)return null;if(!t.match(ar))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=_s.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new Us(hr(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new As}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new Us(hr(r),e.status,r.weak_password.reasons);throw new $s(hr(r),e.status||500,n)}async function fr(e,t,s,r){var n;const i=Object.assign({},null==r?void 0:r.headers);i[ks]||(i[ks]=_s.name),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const a=null!==(n=null==r?void 0:r.query)&&void 0!==n?n:{};(null==r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,s,r,n,i){const a=((e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))})(t,r,n,i);let o;try{o=await e(s,Object.assign({},a))}catch(e){throw console.error(e),new Rs(hr(e),0)}o.ok||await dr(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(e){await dr(e)}}(e,t,s+o,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function pr(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function gr(e){const t=pr(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function vr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function mr(e){return{data:e,error:null}}function yr(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=e,a=cr(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},user:Object.assign({},a)},error:null}}function br(e){return e}const wr=["global","local","others"];var kr=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s};class _r{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Xs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=wr[0]){if(wr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wr.join(", ")}`);try{return await fr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Es(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await fr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:vr})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{const{options:t}=e,s=kr(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await fr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:yr,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(Es(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await fr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:vr})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,s,r,n,i,a,o;try{const l={nextPage:null,lastPage:0,total:0},c=await fr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(n=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==n?n:""},xform:br});if(c.error)throw c.error;const h=await c.json(),u=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(o=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(e){if(Es(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){lr(e);try{return await fr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:vr})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){lr(e);try{return await fr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:vr})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){lr(e);try{return await fr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:vr})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){lr(e.userId);try{const{data:t,error:s}=await fr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(e){if(Es(e))return{data:null,error:e};throw e}}async _deleteFactor(e){lr(e.userId),lr(e.id);try{return{data:await fr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(Es(e))return{data:null,error:e};throw e}}}const Tr={getItem:e=>Ys()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ys()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ys()&&globalThis.localStorage.removeItem(e)}};function Sr(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const Er=!!(globalThis&&Ys()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class $r extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class xr extends $r{}async function jr(e,t,s){Er&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Er&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(!r){if(0===t)throw Er&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new xr(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Er)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}Er&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await s()}finally{Er&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ar={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ws,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ir(e,t,s){return await s()}class Pr{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pr.nextInstanceID,Pr.nextInstanceID+=1,this.instanceID>0&&Ks()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ar),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new _r({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Xs(r.fetch),this.lock=r.lock||Ir,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ks()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=jr:this.lock=Ir,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Ys()?this.storage=Tr:(this.memoryStorage={},this.storage=Sr(this.memoryStorage)):(this.memoryStorage={},this.storage=Sr(this.memoryStorage)),Ks()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ms}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(e){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Ks()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:n}=await this._getSessionFromURL(t,s);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),function(e){return Es(e)&&"AuthImplicitGrantRedirectError"===e.name}(n)){const t=null===(e=n.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}const{session:i,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Es(e)?{error:e}:{error:new xs("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const n=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:pr}),{data:i,error:a}=n;if(a||!i)return{data:{user:null,session:null},error:a};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,s,r;try{let n;if("email"in e){const{email:s,password:r,options:i}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await ir(this.storage,this.storageKey)),n=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:o},xform:pr})}else{if(!("phone"in e))throw new Ps("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:a}=e;n=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(s=null==a?void 0:a.data)&&void 0!==s?s:{},channel:null!==(r=null==a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:pr})}}const{data:i,error:a}=n;if(a||!i)return{data:{user:null,session:null},error:a};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:n}=e;t=await fr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:gr})}else{if(!("phone"in e))throw new Ps("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:n}=e;t=await fr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:gr})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Is}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,s,r,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,n,i,a,o,l,c,h,u,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:u,wallet:d,statement:g,options:v}=e;let m;if(Ks())if("object"==typeof d)m=d;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");m=e.solana}else{if("object"!=typeof d||!(null==v?void 0:v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=d}const y=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href);if("signIn"in m&&m.signIn){const e=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==v?void 0:v.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),g?{statement:g}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in m&&"function"==typeof m.signMessage&&"publicKey"in m&&"object"==typeof m&&m.publicKey&&"toBase58"in m.publicKey&&"function"==typeof m.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${y.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${y.href}`,`Issued At: ${null!==(r=null===(s=null==v?void 0:v.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:(new Date).toISOString()}`,...(null===(n=null==v?void 0:v.signInWithSolana)||void 0===n?void 0:n.notBefore)?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...(null===(i=null==v?void 0:v.signInWithSolana)||void 0===i?void 0:i.expirationTime)?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...(null===(a=null==v?void 0:v.signInWithSolana)||void 0===a?void 0:a.chainId)?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...(null===(o=null==v?void 0:v.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...(null===(l=null==v?void 0:v.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...(null===(h=null===(c=null==v?void 0:v.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===h?void 0:h.length)?["Resources",...v.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await m.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:s}=await fr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:Hs(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:pr});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new Is}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){const t=await Zs(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:n}=await fr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:pr});if(await er(this.storage,`${this.storageKey}-code-verifier`),n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:n}):{data:{user:null,session:null,redirectType:null},error:new Is}}catch(e){if(Es(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:n,nonce:i}=e,a=await fr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:pr}),{data:o,error:l}=a;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Is}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,s,r,n,i;try{if("email"in e){const{email:r,options:n}=e;let i=null,a=null;"pkce"===this.flowType&&([i,a]=await ir(this.storage,this.storageKey));const{error:o}=await fr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(s=null==n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:a,error:o}=await fr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(n=null==s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(i=null==s?void 0:s.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new Ps("You must provide either an email or phone number.")}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,s;try{let r,n;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:i,error:a}=await fr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:r,xform:pr});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,s,r;try{let n=null,i=null;return"pkce"===this.flowType&&([n,i]=await ir(this.storage,this.storageKey)),await fr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:i}),headers:this.headers,xform:mr})}catch(e){if(Es(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new As;const{error:r}=await fr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:n}=e,{error:i}=await fr(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:s,type:r,options:n}=e,{data:i,error:a}=await fr(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:a}}throw new Ps("You must provide either an email or phone number and a type")}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Zs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<bs;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await fr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:vr}):await this._useSession(async e=>{var t,s,r;const{data:n,error:i}=e;if(i)throw i;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await fr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:vr}):{data:{user:null},error:new As}})}catch(e){if(Es(e))return function(e){return Es(e)&&"AuthSessionMissingError"===e.name}(e)&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:n}=s;if(n)throw n;if(!r.session)throw new As;const i=r.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await ir(this.storage,this.storageKey));const{data:l,error:c}=await fr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:i.access_token,xform:vr});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(e){if(Es(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new As;const t=Date.now()/1e3;let s=t,r=!0,n=null;const{payload:i}=sr(e.access_token);if(i.exp&&(s=i.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(e){if(Es(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:r,error:n}=t;if(n)throw n;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new As;const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(Es(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!Ks())throw new Os("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Os(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Cs("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Os("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Cs("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:i,expires_in:a,expires_at:o,token_type:l}=e;if(!(n&&a&&i&&l))throw new Os("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let u=c+h;o&&(u=parseInt(o));const d=u-c;1e3*d<=ys&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const f=u-h;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,c);const{data:p,error:g}=await this._getUser(n);if(g)throw g;const v={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:h,expires_at:u,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(e){if(Es(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Zs(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{error:n};const i=null===(s=r.session)||void 0===s?void 0:s.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Es(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:r},error:n}=t;if(n)throw n;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await ir(this.storage,this.storageKey,!0));try{return await fr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(Es(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(Es(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async t=>{var s,r,n,i,a;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await fr(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(i=o.session)||void 0===i?void 0:i.access_token)&&void 0!==a?a:void 0})});if(r)throw r;return Ks()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(t){if(Es(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:i}=t;if(i)throw i;return await fr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})})}catch(e){if(Es(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await fr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pr})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&Ds(t)&&Date.now()+s-n<ys},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await s(n);if(!r(n,null,t))return void e(t)}catch(e){if(!r(n,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),Es(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ks()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Zs(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const r=1e3*(null!==(e=s.expires_at)&&void 0!==e?e:1/0)-Date.now()<bs;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),Ds(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(e){return this._debug(t,"error",e),void console.error(e)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new As;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new tr;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new As;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),Es(e)){const s={session:null,error:e};return Ds(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(s),s}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],n=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(e){r.push(e)}});if(await Promise.all(n),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Qs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await er(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ks()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ys);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-e)/ys);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof $r))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ks()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await ir(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await fr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(e){if(Es(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await fr(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(Es(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{data:null,error:n};const{data:i,error:a}=await fr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(e){if(Es(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await fr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(e){if(Es(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),n=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:r,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:n}=e;if(n)return{data:null,error:n};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=sr(r.access_token);let a=null;i.aal&&(a=i.aal);let o=a;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;if(s=this.jwks.keys.find(t=>t.kid===e),s&&this.jwks_cached_at+6e5>Date.now())return s;const{data:r,error:n}=await fr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;if(!r.keys||0===r.keys.length)throw new Ns("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),s=r.keys.find(t=>t.kid===e),!s)throw new Ns("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:n,signature:i,raw:{header:a,payload:o}}=sr(s);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(n.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:n,header:r,signature:i},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),h=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,h,i,Fs(`${a}.${o}`)))throw new Ns("Invalid JWT signature");return{data:{claims:n,header:r,signature:i},error:null}}catch(e){if(Es(e))return{data:null,error:e};throw e}}}Pr.nextInstanceID=0;const Or=Pr;class Cr extends Or{constructor(e){super(e)}}var Rr=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};class Dr{constructor(e,t,s){var r,n,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=(o=e).endsWith("/")?o:o+"/";var o;const l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,h=function(e,t){var s,r;const{db:n,auth:i,realtime:a,global:o}=e,{db:l,auth:c,realtime:h,global:u}=t,d={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},h),a),global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(r=null==o?void 0:o.headers)&&void 0!==r?r:{})}),accessToken:()=>vs(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:hs,realtime:ds,auth:Object.assign(Object.assign({},us),{storageKey:c}),global:cs});this.storageKey=null!==(r=h.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(n=h.global.headers)&&void 0!==n?n:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=h.auth)&&void 0!==i?i:{},this.headers,h.global.fetch),this.fetch=gs(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new at(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new ge(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new os(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Rr(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:n,flowType:i,lock:a,debug:o},l,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Cr({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:i,lock:a,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Bt(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){let e=this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)});return e}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const Ur="https://znqxsofyvwflijqrscwd.supabase.co",Nr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpucXhzb2Z5dndmbGlqcXJzY3dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5NTk0OTUsImV4cCI6MjA2NjUzNTQ5NX0.cHt-jmaGjWbVYk4ud8OfhVQ6p20aGAgzwoeWJeVbaEQ";(Ur.includes("YOUR_")||Nr.includes("YOUR_"))&&console.error("⚠️ Supabase credentials not configured. Please replace YOUR_SUPABASE_URL and YOUR_SUPABASE_ANON_KEY in src/lib/supabase.js");const Lr=((e,t,s)=>new Dr(e,t,s))(Ur,Nr,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1}});async function Br(){const{data:{user:e},error:t}=await Lr.auth.getUser();return t?(console.error("Error getting user:",t),null):e}const Mr=[];function qr(t,s=e){let r;const n=new Set;function a(e){if(i(t,e)&&(t=e,r)){const e=!Mr.length;for(const e of n)e[1](),Mr.push(e,t);if(e){for(let e=0;e<Mr.length;e+=2)Mr[e][0](Mr[e+1]);Mr.length=0}}}function o(e){a(e(t))}return{set:a,update:o,subscribe:function(i,l=e){const c=[i,l];return n.add(c),1===n.size&&(r=s(a,o)||e),i(t),()=>{n.delete(c),0===n.size&&r&&(r(),r=null)}}}}const Vr=qr(null),Jr=qr(!0),Wr=qr(""),zr=qr(""),Fr=qr({minutes:25,seconds:0,isActive:!1,isWork:!0,cycles:0,workTime:25,shortBreak:5,longBreak:15,autoStart:!1});function Hr(e,t=3e3){zr.set(e),setTimeout(()=>zr.set(""),t)}function Kr(e,t=5e3){Wr.set(e),setTimeout(()=>Wr.set(""),t)}function Gr(e){let t,s=e[2]?"Let’s Brew":"Create Account";return{c(){t=v(s)},l(e){t=$(e,s)},m(e,s){d(e,t,s)},p(e,r){4&r&&s!==(s=e[2]?"Let’s Brew":"Create Account")&&j(t,s)},d(e){e&&f(t)}}}function Yr(t){let s,r='<span class="svelte-gymk5j"></span> <span class="svelte-gymk5j"></span> <span class="svelte-gymk5j"></span>';return{c(){s=g("span"),s.innerHTML=r,this.h()},l(e){s=E(e,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1slpye5"!==k(s)&&(s.innerHTML=r),this.h()},h(){w(s,"class","loading-dots svelte-gymk5j")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function Xr(t){let s,n,i,a,o,l,c,h,p,y,_,S,I,P,O,C,R,D,U,N,L,B,M,q,V,J="Pomoson",W=t[2]?"Log in to begin.":"Create account",z=t[2]?"New here? Sign up":"Already brewed one? Sign in";function F(e,t){return e[3]?Yr:Gr}let H=F(t),K=H(t);return{c(){s=g("div"),n=g("div"),i=g("h1"),i.textContent=J,a=m(),o=g("p"),l=v(W),c=m(),h=g("div"),p=g("label"),y=g("span"),y.textContent="📧",_=m(),S=g("input"),I=m(),P=g("div"),O=g("label"),C=g("span"),C.textContent="🔒",R=m(),D=g("input"),U=m(),N=g("button"),K.c(),L=m(),B=g("button"),M=v(z),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);n=E(t,"DIV",{class:!0});var r=T(n);i=E(r,"H1",{class:!0,"data-svelte-h":!0}),"svelte-1azs72z"!==k(i)&&(i.textContent=J),a=x(r),o=E(r,"P",{class:!0});var u=T(o);l=$(u,W),u.forEach(f),c=x(r),h=E(r,"DIV",{class:!0});var d=T(h);p=E(d,"LABEL",{class:!0});var g=T(p);y=E(g,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-em5h5r"!==k(y)&&(y.textContent="📧"),_=x(g),S=E(g,"INPUT",{type:!0,placeholder:!0,class:!0}),g.forEach(f),d.forEach(f),I=x(r),P=E(r,"DIV",{class:!0});var v=T(P);O=E(v,"LABEL",{class:!0});var m=T(O);C=E(m,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-be8x2i"!==k(C)&&(C.textContent="🔒"),R=x(m),D=E(m,"INPUT",{type:!0,placeholder:!0,class:!0}),m.forEach(f),v.forEach(f),U=x(r),N=E(r,"BUTTON",{class:!0});var b=T(N);K.l(b),b.forEach(f),L=x(r),B=E(r,"BUTTON",{class:!0});var w=T(B);M=$(w,z),w.forEach(f),r.forEach(f),t.forEach(f),this.h()},h(){w(i,"class","svelte-gymk5j"),w(o,"class","subtitle svelte-gymk5j"),w(y,"class","input-icon svelte-gymk5j"),w(S,"type","email"),w(S,"placeholder","Email address"),w(S,"class","input-field svelte-gymk5j"),S.disabled=t[3],w(p,"class","input-label svelte-gymk5j"),w(h,"class","form-group svelte-gymk5j"),w(C,"class","input-icon svelte-gymk5j"),w(D,"type","password"),w(D,"placeholder","Password"),w(D,"class","input-field svelte-gymk5j"),D.disabled=t[3],w(O,"class","input-label svelte-gymk5j"),w(P,"class","form-group svelte-gymk5j"),w(N,"class","auth-button svelte-gymk5j"),N.disabled=t[3],w(B,"class","toggle-button svelte-gymk5j"),B.disabled=t[3],w(n,"class","auth-card svelte-gymk5j"),w(s,"class","auth-container svelte-gymk5j")},m(e,r){d(e,s,r),u(s,n),u(n,i),u(n,a),u(n,o),u(o,l),u(n,c),u(n,h),u(h,p),u(p,y),u(p,_),u(p,S),A(S,t[0]),u(n,I),u(n,P),u(P,O),u(O,C),u(O,R),u(O,D),A(D,t[1]),u(n,U),u(n,N),K.m(N,null),u(n,L),u(n,B),u(B,M),q||(V=[b(S,"input",t[6]),b(S,"keypress",t[5]),b(D,"input",t[7]),b(D,"keypress",t[5]),b(N,"click",t[4]),b(B,"click",t[8])],q=!0)},p(e,[t]){4&t&&W!==(W=e[2]?"Log in to begin.":"Create account")&&j(l,W),8&t&&(S.disabled=e[3]),1&t&&S.value!==e[0]&&A(S,e[0]),8&t&&(D.disabled=e[3]),2&t&&D.value!==e[1]&&A(D,e[1]),H===(H=F(e))&&K?K.p(e,t):(K.d(1),K=H(e),K&&(K.c(),K.m(N,null))),8&t&&(N.disabled=e[3]),4&t&&z!==(z=e[2]?"New here? Sign up":"Already brewed one? Sign in")&&j(M,z),8&t&&(B.disabled=e[3])},i:e,o:e,d(e){e&&f(s),K.d(),q=!1,r(V)}}}function Qr(e,t,s){let r="",n="",i=!0,a=!1;async function o(){if(r&&n)if(function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}(r))if(n.length<6)Kr("Password must be at least 6 characters");else{s(3,a=!0);try{if(i){const{error:e}=await Lr.auth.signInWithPassword({email:r.trim(),password:n});if(e)throw e;Hr("✅ Logged in successfully!")}else{const{error:e}=await Lr.auth.signUp({email:r.trim(),password:n});if(e)throw e;Hr("✅ Account created! Please check your email to verify.")}}catch(e){Kr(e.message)}finally{s(3,a=!1)}}else Kr("Please enter a valid email address");else Kr("Please fill in all fields")}return[r,n,i,a,o,function(e){"Enter"===e.key&&o()},function(){r=this.value,s(0,r)},function(){n=this.value,s(1,n)},()=>s(2,i=!i)]}class Zr extends le{constructor(e){super(),oe(this,e,Qr,Xr,i,{})}}const en=qr(localStorage.getItem("pomoson-theme")||"Pomoson");function tn(e,t,s){const r=e.slice();return r[29]=t[s],r}function sn(e,t,s){const r=e.slice();return r[32]=t[s],r[34]=s,r}function rn(e){let t,s,r=e[0].cycles%4==0?"Long Break 🌿":"Short Break 🍃";return{c(){t=g("span"),s=v(r),this.h()},l(e){t=E(e,"SPAN",{class:!0});var n=T(t);s=$(n,r),n.forEach(f),this.h()},h(){w(t,"class","status-badge break svelte-rrheck")},m(e,r){d(e,t,r),u(t,s)},p(e,t){1&t[0]&&r!==(r=e[0].cycles%4==0?"Long Break 🌿":"Short Break 🍃")&&j(s,r)},d(e){e&&f(t)}}}function nn(t){let s,r="Focus Time ☕";return{c(){s=g("span"),s.textContent=r,this.h()},l(e){s=E(e,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1d78mfu"!==k(s)&&(s.textContent=r),this.h()},h(){w(s,"class","status-badge work svelte-rrheck")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function an(e){let t,s,r,n,i,a,o,l="What are you working on?";return{c(){t=g("div"),s=g("label"),s.textContent=l,r=m(),n=g("input"),this.h()},l(e){t=E(e,"DIV",{class:!0});var i=T(t);s=E(i,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-1oy5ug8"!==k(s)&&(s.textContent=l),r=x(i),n=E(i,"INPUT",{type:!0,placeholder:!0,class:!0,maxlength:!0}),i.forEach(f),this.h()},h(){w(s,"class","title-label svelte-rrheck"),w(n,"type","text"),w(n,"placeholder","e.g., Writing,Coding,Studying..."),w(n,"class","work-title-input svelte-rrheck"),w(n,"maxlength","100"),n.disabled=i=e[0].isActive,w(t,"class","work-title-section svelte-rrheck")},m(i,l){d(i,t,l),u(t,s),u(t,r),u(t,n),A(n,e[3]),a||(o=b(n,"input",e[13]),a=!0)},p(e,t){1&t[0]&&i!==(i=e[0].isActive)&&(n.disabled=i),8&t[0]&&n.value!==e[3]&&A(n,e[3])},d(e){e&&f(t),a=!1,o()}}}function on(t){let s;return{c(){s=g("span"),s.textContent="🍪",this.h()},l(e){s=E(e,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1w2xqc1"!==k(s)&&(s.textContent="🍪"),this.h()},h(){w(s,"class","bean svelte-rrheck")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function ln(e){let t,s,r,n=e[0].cycles-10+"";return{c(){t=g("span"),s=v("+"),r=v(n),this.h()},l(e){t=E(e,"SPAN",{class:!0});var i=T(t);s=$(i,"+"),r=$(i,n),i.forEach(f),this.h()},h(){w(t,"class","bean-count svelte-rrheck")},m(e,n){d(e,t,n),u(t,s),u(t,r)},p(e,t){1&t[0]&&n!==(n=e[0].cycles-10+"")&&j(r,n)},d(e){e&&f(t)}}}function cn(e){let t,s=Z(e[4]),r=[];for(let t=0;t<s.length;t+=1)r[t]=hn(tn(e,s,t));return{c(){t=g("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var s=T(t);for(let e=0;e<r.length;e+=1)r[e].l(s);s.forEach(f),this.h()},h(){w(t,"class","select-dropdown svelte-rrheck")},m(e,s){d(e,t,s);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)},p(e,n){if(50&n[0]){let i;for(s=Z(e[4]),i=0;i<s.length;i+=1){const a=tn(e,s,i);r[i]?r[i].p(a,n):(r[i]=hn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=s.length}},d(e){e&&f(t),p(r,e)}}}function hn(e){let t,s,r,n,i,a=e[29].label+"";function o(){return e[16](e[29])}return{c(){t=g("button"),s=v(a),r=m(),this.h()},l(e){t=E(e,"BUTTON",{class:!0,type:!0});var n=T(t);s=$(n,a),r=x(n),n.forEach(f),this.h()},h(){w(t,"class","select-option svelte-rrheck"),w(t,"type","button"),P(t,"selected",e[29].value===e[1])},m(e,a){d(e,t,a),u(t,s),u(t,r),n||(i=b(t,"click",o),n=!0)},p(s,r){e=s,18&r[0]&&P(t,"selected",e[29].value===e[1])},d(e){e&&f(t),n=!1,i()}}}function un(t){let s,n,i,a,o,l,c,h,y,_,S,A,I,O,C,R,D,U,N,L,B,M,q,V,J,W,z,F,H,K,G,Y,X,Q,ee,te,se,re,ne,ie,ae,oe,le,ce,he,ue,de,fe,pe,ge,ve,me,ye,be,we,ke,_e,Te,Se,Ee,$e,xe,je,Ae,Ie,Pe,Oe,Ce,Re,De,Ue,Ne,Le,Be,Me,qe,Ve=gn(t[0].minutes,t[0].seconds)+"",Je="↻ Reset",We=t[0].cycles+"",ze="⚙ Settings",Fe="☕ Work Duration (min)",He="🍃 Short Break (min)",Ke="🌿 Long Break (min)",Ge="Auto-start breaks",Ye="🎨 Theme",Xe=(t[4].find(t[15])?.label||"Select Theme")+"";function Qe(e,t){return e[0].isWork?nn:rn}let Ze=Qe(t),et=Ze(t),tt=t[0].isWork&&an(t),st=Z({length:Math.min(t[0].cycles,10)}),rt=[];for(let e=0;e<st.length;e+=1)rt[e]=on(sn(t,st,e));let nt=t[0].cycles>10&&ln(t),it=t[2]&&cn(t);return{c(){s=g("div"),n=g("div"),i=g("div"),a=v(Ve),o=m(),l=g("div"),et.c(),c=m(),tt&&tt.c(),h=m(),y=g("div"),_=g("button"),S=v("► Start"),I=m(),O=g("button"),C=v("◼ Pause"),D=m(),U=g("button"),U.textContent=Je,N=m(),L=g("div"),B=g("div");for(let e=0;e<rt.length;e+=1)rt[e].c();M=m(),nt&&nt.c(),q=m(),V=g("p"),J=v("Completed cycles: "),W=v(We),z=m(),F=g("div"),H=g("h3"),H.textContent=ze,K=m(),G=g("div"),Y=g("label"),X=g("span"),X.textContent=Fe,Q=m(),ee=g("input"),re=m(),ne=g("div"),ie=g("label"),ae=g("span"),ae.textContent=He,oe=m(),le=g("input"),ue=m(),de=g("div"),fe=g("label"),pe=g("span"),pe.textContent=Ke,ge=m(),ve=g("input"),be=m(),we=g("div"),ke=g("label"),_e=g("span"),_e.textContent=Ge,Te=m(),Se=g("label"),Ee=g("input"),xe=m(),je=g("span"),Ae=m(),Ie=g("div"),Pe=g("label"),Oe=g("span"),Oe.textContent=Ye,Ce=m(),Re=g("div"),De=g("button"),Ue=v(Xe),Ne=m(),Le=g("span"),Le.textContent="▼",Be=m(),it&&it.c(),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);n=E(t,"DIV",{class:!0});var r=T(n);i=E(r,"DIV",{class:!0});var u=T(i);a=$(u,Ve),o=x(u),l=E(u,"DIV",{class:!0});var d=T(l);et.l(d),d.forEach(f),u.forEach(f),c=x(r),tt&&tt.l(r),h=x(r),y=E(r,"DIV",{class:!0});var p=T(y);_=E(p,"BUTTON",{class:!0});var g=T(_);S=$(g,"► Start"),g.forEach(f),I=x(p),O=E(p,"BUTTON",{class:!0});var v=T(O);C=$(v,"◼ Pause"),v.forEach(f),D=x(p),U=E(p,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1kemqr5"!==k(U)&&(U.textContent=Je),p.forEach(f),N=x(r),L=E(r,"DIV",{class:!0});var m=T(L);B=E(m,"DIV",{class:!0});var b=T(B);for(let e=0;e<rt.length;e+=1)rt[e].l(b);M=x(b),nt&&nt.l(b),b.forEach(f),q=x(m),V=E(m,"P",{});var w=T(V);J=$(w,"Completed cycles: "),W=$(w,We),w.forEach(f),m.forEach(f),r.forEach(f),z=x(t),F=E(t,"DIV",{class:!0});var j=T(F);H=E(j,"H3",{class:!0,"data-svelte-h":!0}),"svelte-30hek0"!==k(H)&&(H.textContent=ze),K=x(j),G=E(j,"DIV",{class:!0});var A=T(G);Y=E(A,"LABEL",{class:!0});var P=T(Y);X=E(P,"SPAN",{"data-svelte-h":!0}),"svelte-1qvjg17"!==k(X)&&(X.textContent=Fe),Q=x(P),ee=E(P,"INPUT",{type:!0,min:!0,max:!0,class:!0}),P.forEach(f),A.forEach(f),re=x(j),ne=E(j,"DIV",{class:!0});var R=T(ne);ie=E(R,"LABEL",{class:!0});var Z=T(ie);ae=E(Z,"SPAN",{"data-svelte-h":!0}),"svelte-fzojed"!==k(ae)&&(ae.textContent=He),oe=x(Z),le=E(Z,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Z.forEach(f),R.forEach(f),ue=x(j),de=E(j,"DIV",{class:!0});var te=T(de);fe=E(te,"LABEL",{class:!0});var se=T(fe);pe=E(se,"SPAN",{"data-svelte-h":!0}),"svelte-1t3he35"!==k(pe)&&(pe.textContent=Ke),ge=x(se),ve=E(se,"INPUT",{type:!0,min:!0,max:!0,class:!0}),se.forEach(f),te.forEach(f),be=x(j),we=E(j,"DIV",{class:!0});var ce=T(we);ke=E(ce,"LABEL",{class:!0});var he=T(ke);_e=E(he,"SPAN",{"data-svelte-h":!0}),"svelte-1525vkw"!==k(_e)&&(_e.textContent=Ge),Te=x(he),Se=E(he,"LABEL",{class:!0});var me=T(Se);Ee=E(me,"INPUT",{type:!0,class:!0}),xe=x(me),je=E(me,"SPAN",{class:!0}),T(je).forEach(f),me.forEach(f),he.forEach(f),ce.forEach(f),Ae=x(j),Ie=E(j,"DIV",{class:!0});var ye=T(Ie);Pe=E(ye,"LABEL",{class:!0});var $e=T(Pe);Oe=E($e,"SPAN",{"data-svelte-h":!0}),"svelte-1qocb"!==k(Oe)&&(Oe.textContent=Ye),Ce=x($e),Re=E($e,"DIV",{class:!0});var Me=T(Re);De=E(Me,"BUTTON",{class:!0,type:!0});var qe=T(De);Ue=$(qe,Xe),Ne=x(qe),Le=E(qe,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-13ih5fn"!==k(Le)&&(Le.textContent="▼"),qe.forEach(f),Be=x(Me),it&&it.l(Me),Me.forEach(f),$e.forEach(f),ye.forEach(f),j.forEach(f),t.forEach(f),this.h()},h(){w(l,"class","timer-status svelte-rrheck"),w(i,"class","timer-display svelte-rrheck"),_.disabled=A=t[0].isActive,w(_,"class","control-btn svelte-rrheck"),O.disabled=R=!t[0].isActive,w(O,"class","control-btn svelte-rrheck"),w(U,"class","control-btn svelte-rrheck"),w(y,"class","timer-controls svelte-rrheck"),w(B,"class","coffee-beans svelte-rrheck"),w(L,"class","cycles-counter svelte-rrheck"),w(n,"class","timer-section svelte-rrheck"),w(H,"class","svelte-rrheck"),w(ee,"type","text"),ee.value=te=t[0].workTime,w(ee,"min","1"),w(ee,"max","60"),w(ee,"class","setting-input svelte-rrheck"),ee.disabled=se=t[0].isActive,w(Y,"class","setting-label svelte-rrheck"),w(G,"class","setting-group svelte-rrheck"),w(le,"type","text"),le.value=ce=t[0].shortBreak,w(le,"min","1"),w(le,"max","30"),w(le,"class","setting-input svelte-rrheck"),le.disabled=he=t[0].isActive,w(ie,"class","setting-label svelte-rrheck"),w(ne,"class","setting-group svelte-rrheck"),w(ve,"type","text"),ve.value=me=t[0].longBreak,w(ve,"min","1"),w(ve,"max","60"),w(ve,"class","setting-input svelte-rrheck"),ve.disabled=ye=t[0].isActive,w(fe,"class","setting-label svelte-rrheck"),w(de,"class","setting-group svelte-rrheck"),w(Ee,"type","checkbox"),w(Ee,"class","switch-input svelte-rrheck"),Ee.disabled=$e=t[0].isActive,w(je,"class","slider svelte-rrheck"),w(Se,"class","switch svelte-rrheck"),w(ke,"class","setting-label svelte-rrheck"),w(we,"class","setting-group svelte-rrheck"),w(Le,"class","select-arrow svelte-rrheck"),P(Le,"open",t[2]),w(De,"class","select-button svelte-rrheck"),w(De,"type","button"),w(Re,"class","custom-select svelte-rrheck"),w(Pe,"class","setting-label svelte-rrheck"),w(Ie,"class","setting-group svelte-rrheck"),w(F,"class","settings-section svelte-rrheck"),w(s,"class","pomodoro-container svelte-rrheck")},m(e,r){d(e,s,r),u(s,n),u(n,i),u(i,a),u(i,o),u(i,l),et.m(l,null),u(n,c),tt&&tt.m(n,null),u(n,h),u(n,y),u(y,_),u(_,S),u(y,I),u(y,O),u(O,C),u(y,D),u(y,U),u(n,N),u(n,L),u(L,B);for(let e=0;e<rt.length;e+=1)rt[e]&&rt[e].m(B,null);u(B,M),nt&&nt.m(B,null),u(L,q),u(L,V),u(V,J),u(V,W),u(s,z),u(s,F),u(F,H),u(F,K),u(F,G),u(G,Y),u(Y,X),u(Y,Q),u(Y,ee),u(F,re),u(F,ne),u(ne,ie),u(ie,ae),u(ie,oe),u(ie,le),u(F,ue),u(F,de),u(de,fe),u(fe,pe),u(fe,ge),u(fe,ve),u(F,be),u(F,we),u(we,ke),u(ke,_e),u(ke,Te),u(ke,Se),u(Se,Ee),Ee.checked=t[0].autoStart,u(Se,xe),u(Se,je),u(F,Ae),u(F,Ie),u(Ie,Pe),u(Pe,Oe),u(Pe,Ce),u(Pe,Re),u(Re,De),u(De,Ue),u(De,Ne),u(De,Le),u(Re,Be),it&&it.m(Re,null),Me||(qe=[b(_,"click",t[7]),b(O,"click",t[8]),b(U,"click",t[9]),b(ee,"change",t[10]),b(le,"change",t[11]),b(ve,"change",t[12]),b(Ee,"change",t[14]),b(De,"click",t[6])],Me=!0)},p(e,t){if(1&t[0]&&Ve!==(Ve=gn(e[0].minutes,e[0].seconds)+"")&&j(a,Ve),Ze===(Ze=Qe(e))&&et?et.p(e,t):(et.d(1),et=Ze(e),et&&(et.c(),et.m(l,null))),e[0].isWork?tt?tt.p(e,t):(tt=an(e),tt.c(),tt.m(n,h)):tt&&(tt.d(1),tt=null),1&t[0]&&A!==(A=e[0].isActive)&&(_.disabled=A),1&t[0]&&R!==(R=!e[0].isActive)&&(O.disabled=R),1&t[0]){let s;for(st=Z({length:Math.min(e[0].cycles,10)}),s=0;s<st.length;s+=1){const r=sn(e,st,s);rt[s]?rt[s].p(r,t):(rt[s]=on(),rt[s].c(),rt[s].m(B,M))}for(;s<rt.length;s+=1)rt[s].d(1);rt.length=st.length}e[0].cycles>10?nt?nt.p(e,t):(nt=ln(e),nt.c(),nt.m(B,null)):nt&&(nt.d(1),nt=null),1&t[0]&&We!==(We=e[0].cycles+"")&&j(W,We),1&t[0]&&te!==(te=e[0].workTime)&&ee.value!==te&&(ee.value=te),1&t[0]&&se!==(se=e[0].isActive)&&(ee.disabled=se),1&t[0]&&ce!==(ce=e[0].shortBreak)&&le.value!==ce&&(le.value=ce),1&t[0]&&he!==(he=e[0].isActive)&&(le.disabled=he),1&t[0]&&me!==(me=e[0].longBreak)&&ve.value!==me&&(ve.value=me),1&t[0]&&ye!==(ye=e[0].isActive)&&(ve.disabled=ye),1&t[0]&&$e!==($e=e[0].isActive)&&(Ee.disabled=$e),1&t[0]&&(Ee.checked=e[0].autoStart),2&t[0]&&Xe!==(Xe=(e[4].find(e[15])?.label||"Select Theme")+"")&&j(Ue,Xe),4&t[0]&&P(Le,"open",e[2]),e[2]?it?it.p(e,t):(it=cn(e),it.c(),it.m(Re,null)):it&&(it.d(1),it=null)},i:e,o:e,d(e){e&&f(s),et.d(),tt&&tt.d(),p(rt,e),nt&&nt.d(),it&&it.d(),Me=!1,r(qe)}}}function dn(e){if(!e)return"";const t=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"],s=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"],r=["०","१","२","३","४","५","६","७","८","९"];let n=e.toString();for(let e=0;e<10;e++){const i=new RegExp(t[e],"g"),a=new RegExp(s[e],"g"),o=new RegExp(r[e],"g");n=n.replace(i,e),n=n.replace(a,e),n=n.replace(o,e)}return n}function fn(e,t,s){const r=dn(e),n=parseInt(r);return isNaN(n)||n<t||n>s?null:n}function pn(){localStorage.removeItem("pomoson-timer-state")}function gn(e,t){return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function vn(e,t,s){let r;a(e,en,e=>s(19,r=e));let n,i,o=r,l=!1;function c(e){s(1,o=e),en.set(e),s(2,l=!1)}function h(e){e.target.closest(".custom-select")||s(2,l=!1)}let u={minutes:25,seconds:0,isActive:!1,isWork:!0,cycles:0,workTime:25,shortBreak:5,longBreak:15,autoStart:!0,startTime:null,totalDuration:0,endTime:null},d="";function f(){const e={...u,currentWorkTitle:d,timestamp:Date.now()};localStorage.setItem("pomoson-timer-state",JSON.stringify(e))}function p(){if(u.isActive)return;u.isWork&&!d.trim()&&s(3,d="Pomodoro Work Session");const e=Date.now(),t=60*u.minutes+u.seconds;s(0,u.isActive=!0,u),s(0,u.startTime=e,u),s(0,u.endTime=e+1e3*t,u),s(0,u.totalDuration=t,u),s(0,u={...u}),f(),n=setInterval(()=>{v()},1e3),i=setInterval(()=>{m()},500)}function g(){s(0,u.isActive=!1,u),s(0,u.startTime=null,u),s(0,u.endTime=null,u),s(0,u={...u}),f(),n&&(clearInterval(n),n=null),i&&(clearInterval(i),i=null)}function v(){if(u.isActive){if(0===u.seconds){if(0===u.minutes)return void y();s(0,u.minutes--,u),s(0,u.seconds=59,u)}else s(0,u.seconds--,u);s(0,u={...u}),f()}}function m(){if(!u.isActive||!u.endTime)return;const e=Date.now(),t=u.endTime-e;if(t<=0)return void y();const r=Math.ceil(t/1e3),n=Math.floor(r/60),i=r%60;n===u.minutes&&i===u.seconds||(s(0,u.minutes=n,u),s(0,u.seconds=i,u),s(0,u={...u}),f())}async function y(){if(g(),pn(),u.isWork){try{await async function(){const e=await Br();if(!e)return;const t=new Date,s=new Date(t);s.setMinutes(s.getMinutes()-u.workTime);const r=d.trim()||"Pomodoro Work Session",{error:n}=await Lr.from("worklogs").insert({user_id:e.id,title:r,description:`Completed ${u.workTime} minute focused work session`,start_time:s.toISOString(),end_time:t.toISOString(),duration:60*u.workTime,date:t.toISOString().split("T")[0]});if(n)throw n}()}catch(e){console.error("Error creating worklog:",e),Kr("Failed to save work session")}s(0,u.cycles++,u),s(0,u.isWork=!1,u);const e=u.cycles%4==0;s(0,u.minutes=e?u.longBreak:u.shortBreak,u),s(0,u.seconds=0,u),Hr(`Work session complete! Time for a ${e?"long":"short"} break.`),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission(),"Notification"in window&&"granted"===Notification.permission&&new Notification("Pomoson Timer",{body:`Work session complete! Time for a ${e?"long":"short"} break.`,icon:"/favicon.ico"}),u.autoStart&&p()}else s(0,u.isWork=!0,u),s(0,u.minutes=u.workTime,u),s(0,u.seconds=0,u),Hr("☕ Break time over! Ready for another work session?"),"Notification"in window&&"granted"===Notification.permission&&new Notification("Pomoson Timer",{body:"Break time over! Ready for another work session?",icon:"/favicon.ico"}),u.autoStart&&s(3,d="");s(0,u={...u}),f()}function b(){if(u.isActive&&g(),u.isWork)s(0,u.minutes=u.workTime,u);else{const e=u.cycles%4==0;s(0,u.minutes=e?u.longBreak:u.shortBreak,u)}s(0,u.seconds=0,u),s(0,u={...u}),u.isActive||f()}function w(){document.hidden?console.log("Page hidden - relying on timestamp-based timer"):(console.log("Page visible - both timers active"),u.isActive&&m())}var k;R(()=>{const e=localStorage.getItem("pomoson-settings");if(e)try{const t=JSON.parse(e);s(0,u.workTime=t.workTime||25,u),s(0,u.shortBreak=t.shortBreak||5,u),s(0,u.longBreak=t.longBreak||15,u),s(0,u.autoStart=void 0===t.autoStart||t.autoStart,u)}catch(e){console.error("Error loading settings:",e)}(function(){try{const e=localStorage.getItem("pomoson-timer-state");if(e){const t=JSON.parse(e),r=Date.now()-t.timestamp;if(t.isActive&&r<864e5){const e=Math.floor(r/1e3),n=60*t.minutes+t.seconds-e;n>0?(s(0,u.minutes=Math.floor(n/60),u),s(0,u.seconds=n%60,u),s(0,u.isActive=!0,u),s(0,u.startTime=t.startTime,u),s(0,u.endTime=t.endTime,u),s(0,u.totalDuration=t.totalDuration,u)):(s(0,u.minutes=0,u),s(0,u.seconds=0,u),s(0,u.isActive=!1,u))}else s(0,u.minutes=t.minutes,u),s(0,u.seconds=t.seconds,u),s(0,u.isActive=!1,u);return s(0,u.isWork=t.isWork,u),s(0,u.cycles=t.cycles,u),s(0,u.workTime=t.workTime,u),s(0,u.shortBreak=t.shortBreak,u),s(0,u.longBreak=t.longBreak,u),s(0,u.autoStart=t.autoStart,u),s(3,d=t.currentWorkTitle||""),s(0,u={...u}),!0}}catch(e){console.error("Error loading timer state:",e)}return!1})()||s(0,u.minutes=u.workTime,u),s(0,u={...u}),u.isActive&&(n=setInterval(()=>{v()},1e3),i=setInterval(()=>{m()},500)),document.addEventListener("click",h),document.addEventListener("visibilitychange",w),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()}),k=()=>{g();try{localStorage.setItem("pomoson-settings",JSON.stringify({workTime:u.workTime,shortBreak:u.shortBreak,longBreak:u.longBreak,autoStart:u.autoStart}))}catch(e){console.error("Error saving settings:",e)}document.removeEventListener("click",h),document.removeEventListener("visibilitychange",w)},C().$$.on_destroy.push(k);return e.$$.update=()=>{1&e.$$.dirty[0]&&Fr.set(u)},[u,o,l,d,[{value:"Pomoson",label:"Pomoson"},{value:"dracula",label:"Dracula"},{value:"gruvbox",label:"Gruvbox"},{value:"jungle",label:"Jungle"},{value:"light",label:"Light"},{value:"mono",label:"Mono"},{value:"yellow-gruvbox",label:"Yellow Gruvbox"},{value:"pink-acid",label:"Pink Acid"},{value:"frosty-blue",label:"Frosty Blue"},{value:"warm-gruvbox",label:"Warm Gruvbox"},{value:"blue-purple-green",label:"Blue Purple Green"},{value:"neon-night",label:"Neon Night"},{value:"solarized-teal",label:"Solarized Teal"},{value:"mystical-purple",label:"Mystical Purple"},{value:"sunset-sky",label:"Sunset Sky"},{value:"matrix",label:"Matrix"}],c,function(){s(2,l=!l)},p,g,function(){g(),s(0,u.isWork=!0,u),s(0,u.minutes=u.workTime,u),s(0,u.seconds=0,u),s(0,u.cycles=0,u),s(0,u.startTime=null,u),s(0,u.endTime=null,u),s(0,u.totalDuration=0,u),s(3,d=""),s(0,u={...u}),pn()},function(e){const t=fn(dn(e.target.value),1,60);null!==t?(s(0,u.workTime=t,u),e.target.value=t,b()):e.target.value=u.workTime},function(e){const t=fn(dn(e.target.value),1,30);null!==t?(s(0,u.shortBreak=t,u),e.target.value=t,b()):e.target.value=u.shortBreak},function(e){const t=fn(dn(e.target.value),1,60);null!==t?(s(0,u.longBreak=t,u),e.target.value=t,b()):e.target.value=u.longBreak},function(){d=this.value,s(3,d)},function(){u.autoStart=this.checked,s(0,u)},e=>e.value===o,e=>c(e.value)]}en.subscribe(e=>{localStorage.setItem("pomoson-theme",e),document.documentElement.setAttribute("data-theme",e)});class mn extends le{constructor(e){super(),oe(this,e,vn,un,i,{},null,[-1,-1])}}function yn(e,t,s){const r=e.slice();return r[19]=t[s],r}function bn(e){let t,s=[],r=new Map,n=Z(e[5]);const i=e=>e[19].id;for(let t=0;t<n.length;t+=1){let a=yn(e,n,t),o=i(a);r.set(o,s[t]=_n(o,a))}return{c(){t=g("div");for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var r=T(t);for(let e=0;e<s.length;e+=1)s[e].l(r);r.forEach(f),this.h()},h(){w(t,"class","todos-list svelte-1396136")},m(e,r){d(e,t,r);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,a){928&a&&(n=Z(e[5]),s=te(s,a,i,0,e,n,r,t,ee,_n,null,yn))},d(e){e&&f(t);for(let e=0;e<s.length;e+=1)s[e].d()}}}function wn(e){let t,s,r,n,i,a,o,l,c="completed"===e[1]?"No completed tasks yet":"Your task list is empty",h="completed"===e[1]?"Complete some tasks to see them here!":"Add your first task above ☕";return{c(){t=g("div"),s=g("div"),s.textContent="🍃",r=m(),n=g("h3"),i=v(c),a=m(),o=g("p"),l=v(h),this.h()},l(e){t=E(e,"DIV",{class:!0});var u=T(t);s=E(u,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1sodofo"!==k(s)&&(s.textContent="🍃"),r=x(u),n=E(u,"H3",{class:!0});var d=T(n);i=$(d,c),d.forEach(f),a=x(u),o=E(u,"P",{class:!0});var p=T(o);l=$(p,h),p.forEach(f),u.forEach(f),this.h()},h(){w(s,"class","coffee-icon"),w(n,"class","svelte-1396136"),w(o,"class","svelte-1396136"),w(t,"class","empty-state svelte-1396136")},m(e,c){d(e,t,c),u(t,s),u(t,r),u(t,n),u(n,i),u(t,a),u(t,o),u(o,l)},p(e,t){2&t&&c!==(c="completed"===e[1]?"No completed tasks yet":"Your task list is empty")&&j(i,c),2&t&&h!==(h="completed"===e[1]?"Complete some tasks to see them here!":"Add your first task above ☕")&&j(l,h)},d(e){e&&f(t)}}}function kn(t){let s,r='<div class="coffee-cup">☕</div> <p>Brewing your tasks...</p>';return{c(){s=g("div"),s.innerHTML=r,this.h()},l(e){s=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-12vyvft"!==k(s)&&(s.innerHTML=r),this.h()},h(){w(s,"class","loading-state svelte-1396136")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function _n(e,t){let s,n,i,a,o,l,c,h,p,y,_,S,A,I,O,C,R,D,U,N,L,B,M,q=t[19].text+"",V=Sn(t[19].created_at)+"",J=t[19].pomodoro_count>0?`×${t[19].pomodoro_count}`:"Add";function W(){return t[15](t[19])}function z(){return t[16](t[19])}function F(){return t[17](t[19])}return{key:e,first:null,c(){s=g("div"),n=g("label"),i=g("input"),o=m(),l=g("span"),c=m(),h=g("span"),p=v(q),y=m(),_=g("div"),S=g("span"),A=v("📅 "),I=v(V),O=m(),C=g("button"),R=v("🍅 "),D=v(J),U=m(),N=g("button"),N.textContent="🗑️",L=m(),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);n=E(t,"LABEL",{class:!0});var r=T(n);i=E(r,"INPUT",{type:!0,class:!0}),o=x(r),l=E(r,"SPAN",{class:!0}),T(l).forEach(f),c=x(r),h=E(r,"SPAN",{class:!0});var a=T(h);p=$(a,q),a.forEach(f),r.forEach(f),y=x(t),_=E(t,"DIV",{class:!0});var u=T(_);S=E(u,"SPAN",{class:!0});var d=T(S);A=$(d,"📅 "),I=$(d,V),d.forEach(f),O=x(u),C=E(u,"BUTTON",{class:!0});var g=T(C);R=$(g,"🍅 "),D=$(g,J),g.forEach(f),u.forEach(f),U=x(t),N=E(t,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-ypgxyt"!==k(N)&&(N.textContent="🗑️"),L=x(t),t.forEach(f),this.h()},h(){w(i,"type","checkbox"),i.checked=a=t[19].completed,w(i,"class","checkbox svelte-1396136"),w(l,"class","checkmark svelte-1396136"),w(h,"class","todo-text svelte-1396136"),w(n,"class","todo-checkbox svelte-1396136"),w(S,"class","todo-date"),w(C,"class","pomodoro-btn svelte-1396136"),w(_,"class","todo-meta svelte-1396136"),w(N,"class","delete-btn svelte-1396136"),w(s,"class","todo-item svelte-1396136"),P(s,"completed",t[19].completed),this.first=s},m(e,t){d(e,s,t),u(s,n),u(n,i),u(n,o),u(n,l),u(n,c),u(n,h),u(h,p),u(s,y),u(s,_),u(_,S),u(S,A),u(S,I),u(_,O),u(_,C),u(C,R),u(C,D),u(s,U),u(s,N),u(s,L),B||(M=[b(i,"change",W),b(C,"click",z),b(N,"click",F)],B=!0)},p(e,r){t=e,32&r&&a!==(a=t[19].completed)&&(i.checked=a),32&r&&q!==(q=t[19].text+"")&&j(p,q),32&r&&V!==(V=Sn(t[19].created_at)+"")&&j(I,V),32&r&&J!==(J=t[19].pomodoro_count>0?`×${t[19].pomodoro_count}`:"Add")&&j(D,J),32&r&&P(s,"completed",t[19].completed)},d(e){e&&f(s),B=!1,r(M)}}}function Tn(t){let s,n,i,a,o,l,c,h,p,y,_,S,I,O,C,R,D,U,N,L,B,M,q,V,J,W,z,F,H,K,G,Y,X,Q,Z=t[0].length+"",ee=t[0].filter(En).length+"",te=t[0].filter($n).length+"",se=t[4]?"...":"Add",re=t[2].length+"";function ne(e,t){return e[3]?kn:0===e[5].length?wn:bn}let ie=ne(t),ae=ie(t);return{c(){s=g("div"),n=g("div"),i=g("div"),a=g("button"),o=v("All Tasks ("),l=v(Z),c=v(")"),h=m(),p=g("button"),y=v("Active ("),_=v(ee),S=v(")"),I=m(),O=g("button"),C=v("Completed ("),R=v(te),D=v(")"),U=m(),N=g("div"),L=g("div"),B=g("span"),B.textContent="＋",M=m(),q=g("input"),V=m(),J=g("button"),W=v(se),F=m(),H=g("div"),K=v(re),G=v("/500"),Y=m(),ae.c(),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);n=E(t,"DIV",{class:!0});var r=T(n);i=E(r,"DIV",{class:!0});var u=T(i);a=E(u,"BUTTON",{class:!0});var d=T(a);o=$(d,"All Tasks ("),l=$(d,Z),c=$(d,")"),d.forEach(f),h=x(u),p=E(u,"BUTTON",{class:!0});var g=T(p);y=$(g,"Active ("),_=$(g,ee),S=$(g,")"),g.forEach(f),I=x(u),O=E(u,"BUTTON",{class:!0});var v=T(O);C=$(v,"Completed ("),R=$(v,te),D=$(v,")"),v.forEach(f),u.forEach(f),r.forEach(f),U=x(t),N=E(t,"DIV",{class:!0});var m=T(N);L=E(m,"DIV",{class:!0});var b=T(L);B=E(b,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-8znadz"!==k(B)&&(B.textContent="＋"),M=x(b),q=E(b,"INPUT",{placeholder:!0,class:!0,maxlength:!0}),V=x(b),J=E(b,"BUTTON",{class:!0});var w=T(J);W=$(w,se),w.forEach(f),b.forEach(f),F=x(m),H=E(m,"DIV",{class:!0});var j=T(H);K=$(j,re),G=$(j,"/500"),j.forEach(f),m.forEach(f),Y=x(t),ae.l(t),t.forEach(f),this.h()},h(){w(a,"class","svelte-1396136"),P(a,"active","all"===t[1]),w(p,"class","svelte-1396136"),P(p,"active","active"===t[1]),w(O,"class","svelte-1396136"),P(O,"active","completed"===t[1]),w(i,"class","tabs svelte-1396136"),w(n,"class","todos-header svelte-1396136"),w(B,"class","icon svelte-1396136"),w(q,"placeholder","Add a new task..."),w(q,"class","todo-input svelte-1396136"),q.disabled=t[4],w(q,"maxlength","500"),w(J,"class","add-btn svelte-1396136"),J.disabled=z=t[4]||!t[2].trim(),w(L,"class","input-container svelte-1396136"),w(H,"class","char-counter svelte-1396136"),w(N,"class","add-todo svelte-1396136"),w(s,"class","todos-container svelte-1396136")},m(e,r){d(e,s,r),u(s,n),u(n,i),u(i,a),u(a,o),u(a,l),u(a,c),u(i,h),u(i,p),u(p,y),u(p,_),u(p,S),u(i,I),u(i,O),u(O,C),u(O,R),u(O,D),u(s,U),u(s,N),u(N,L),u(L,B),u(L,M),u(L,q),A(q,t[2]),u(L,V),u(L,J),u(J,W),u(N,F),u(N,H),u(H,K),u(H,G),u(s,Y),ae.m(s,null),X||(Q=[b(a,"click",t[11]),b(p,"click",t[12]),b(O,"click",t[13]),b(q,"input",t[14]),b(q,"keypress",t[10]),b(J,"click",t[6])],X=!0)},p(e,[t]){1&t&&Z!==(Z=e[0].length+"")&&j(l,Z),2&t&&P(a,"active","all"===e[1]),1&t&&ee!==(ee=e[0].filter(En).length+"")&&j(_,ee),2&t&&P(p,"active","active"===e[1]),1&t&&te!==(te=e[0].filter($n).length+"")&&j(R,te),2&t&&P(O,"active","completed"===e[1]),16&t&&(q.disabled=e[4]),4&t&&q.value!==e[2]&&A(q,e[2]),16&t&&se!==(se=e[4]?"...":"Add")&&j(W,se),20&t&&z!==(z=e[4]||!e[2].trim())&&(J.disabled=z),4&t&&re!==(re=e[2].length+"")&&j(K,re),ie===(ie=ne(e))&&ae?ae.p(e,t):(ae.d(1),ae=ie(e),ae&&(ae.c(),ae.m(s,null)))},i:e,o:e,d(e){e&&f(s),ae.d(),X=!1,r(Q)}}}function Sn(e){return new Date(e).toLocaleDateString()}const En=e=>!e.completed,$n=e=>e.completed;function xn(e,t,s){let r,n=[],i="",a=!1,o=!1;async function l(){const e=i.trim();if(e)if(e.length>500)Kr("Task is too long (max 500 characters)");else try{s(4,o=!0);const t=await Br();if(!t)return;const{data:r,error:a}=await Lr.from("todos").insert({user_id:t.id,text:e}).select();if(a)throw a;r&&r[0]&&s(0,n=[r[0],...n]),s(2,i=""),Hr("✅ Task added successfully!")}catch(e){console.error("Error adding todo:",e),Kr("Failed to add task")}finally{s(4,o=!1)}else Kr("Please enter a task")}async function c(e){try{const{error:t}=await Lr.from("todos").update({completed:!e.completed}).eq("id",e.id);if(t)throw t;s(0,n=n.map(t=>t.id===e.id?{...t,completed:!t.completed}:t)),Hr(e.completed?"↩️ Task reopened":"✅ Task completed!")}catch(e){console.error("Error toggling todo:",e),Kr("Failed to update task")}}async function h(e){if(confirm("Are you sure you want to delete this task?"))try{const{error:t}=await Lr.from("todos").delete().eq("id",e);if(t)throw t;s(0,n=n.filter(t=>t.id!==e)),Hr("🗑️ Task deleted")}catch(e){console.error("Error deleting todo:",e),Kr("Failed to delete task")}}async function u(e){try{const{error:t}=await Lr.from("todos").update({pomodoro_count:e.pomodoro_count+1}).eq("id",e.id);if(t)throw t;s(0,n=n.map(t=>t.id===e.id?{...t,pomodoro_count:t.pomodoro_count+1}:t)),Hr("🍅 Pomodoro added!")}catch(e){console.error("Error incrementing pomodoro:",e),Kr("Failed to add pomodoro")}}R(()=>{!async function(){try{s(3,a=!0);const e=await Br();if(!e)return;const{data:t,error:r}=await Lr.from("todos").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(r)throw r;s(0,n=t||[])}catch(e){console.error("Error fetching todos:",e),Kr("Failed to load todos")}finally{s(3,a=!1)}}()});let d="all";return e.$$.update=()=>{3&e.$$.dirty&&s(5,r=n.filter(e=>"active"===d?!e.completed:"completed"!==d||e.completed))},[n,d,i,a,o,r,l,c,h,u,function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),l())},()=>s(1,d="all"),()=>s(1,d="active"),()=>s(1,d="completed"),function(){i=this.value,s(2,i)},e=>c(e),e=>u(e),e=>h(e.id)]}class jn extends le{constructor(e){super(),oe(this,e,xn,Tn,i,{})}}function An(e,t,s){const r=e.slice();return r[58]=t[s],r}function In(e,t,s){const r=e.slice();return r[61]=t[s],r}function Pn(e,t,s){const r=e.slice();return r[61]=t[s],r}function On(e){let t;return{c(){t=g("div"),t.textContent="🔍",this.h()},l(e){t=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-vq0d55"!==k(t)&&(t.textContent="🔍"),this.h()},h(){w(t,"class","search-indicator svelte-59k27k")},m(e,s){d(e,t,s)},d(e){e&&f(t)}}}function Cn(e){let t,s=Z(e[13]),r=[];for(let t=0;t<s.length;t+=1)r[t]=Rn(Pn(e,s,t));return{c(){t=g("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var s=T(t);for(let e=0;e<r.length;e+=1)r[e].l(s);s.forEach(f),this.h()},h(){w(t,"class","suggestions-dropdown svelte-59k27k")},m(e,s){d(e,t,s);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)},p(e,n){if(16785408&n[0]){let i;for(s=Z(e[13]),i=0;i<s.length;i+=1){const a=Pn(e,s,i);r[i]?r[i].p(a,n):(r[i]=Rn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=s.length}},d(e){e&&f(t),p(r,e)}}}function Rn(e){let t,s,r,n,i,a,o,l,c=e[61].key+"",h=e[61].summary+"";function p(){return e[39](e[61])}return{c(){t=g("div"),s=g("strong"),r=v(c),n=v(" — "),i=v(h),a=m(),this.h()},l(e){t=E(e,"DIV",{class:!0});var o=T(t);s=E(o,"STRONG",{class:!0});var l=T(s);r=$(l,c),l.forEach(f),n=$(o," — "),i=$(o,h),a=x(o),o.forEach(f),this.h()},h(){w(s,"class","svelte-59k27k"),w(t,"class","suggestion-item svelte-59k27k")},m(e,c){d(e,t,c),u(t,s),u(s,r),u(t,n),u(t,i),u(t,a),o||(l=b(t,"mousedown",p),o=!0)},p(t,s){e=t,8192&s[0]&&c!==(c=e[61].key+"")&&j(r,c),8192&s[0]&&h!==(h=e[61].summary+"")&&j(i,h)},d(e){e&&f(t),o=!1,l()}}}function Dn(e){let t,s=[],r=new Map,n=Z(e[2]);const i=e=>e[58].id;for(let t=0;t<n.length;t+=1){let a=An(e,n,t),o=i(a);r.set(o,s[t]=Fn(o,a))}return{c(){t=g("div");for(let e=0;e<s.length;e+=1)s[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var r=T(t);for(let e=0;e<s.length;e+=1)s[e].l(r);r.forEach(f),this.h()},h(){w(t,"class","worklogs-list svelte-59k27k")},m(e,r){d(e,t,r);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,a){2057799428&a[0]|5&a[1]&&(n=Z(e[2]),s=te(s,a,i,0,e,n,r,t,ee,Fn,null,An))},d(e){e&&f(t);for(let e=0;e<s.length;e+=1)s[e].d()}}}function Un(t){let s,r='<div class="coffee-icon">📭</div> <h3 class="svelte-59k27k">No logs for this date</h3> <p class="svelte-59k27k">Start a Pomodoro session or add a manual entry above</p>';return{c(){s=g("div"),s.innerHTML=r,this.h()},l(e){s=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-3tklq7"!==k(s)&&(s.innerHTML=r),this.h()},h(){w(s,"class","empty-state svelte-59k27k")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function Nn(t){let s,r='<div class="coffee-cup">☕</div> <p>Brewing your logs...</p>';return{c(){s=g("div"),s.innerHTML=r,this.h()},l(e){s=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-xpizsg"!==k(s)&&(s.innerHTML=r),this.h()},h(){w(s,"class","loading-state svelte-59k27k")},m(e,t){d(e,s,t)},p:e,d(e){e&&f(s)}}}function Ln(e){let t,s,n,i,a,o,l,c,h,p,y,_,S,A,I,P,O,C,R,D,U,N,L=Xn(e[58].start_time)+"",B=Xn(e[58].end_time)+"",M=e[58].title+"",q=Yn(e[58].title),V=Qn(e[58].duration)+"",J=Yn(e[58].title)&&e[21](),W=q&&Mn(),z=e[58].description&&qn(e),F=J&&Vn(e);function H(){return e[47](e[58])}function K(){return e[48](e[58])}return{c(){t=g("div"),s=g("div"),n=v(L),i=v(" - "),a=v(B),o=m(),l=g("h4"),c=v(M),h=m(),W&&W.c(),p=m(),z&&z.c(),y=m(),_=g("div"),S=g("div"),A=v(V),I=m(),P=g("div"),F&&F.c(),O=m(),C=g("button"),C.textContent="✏️",R=m(),D=g("button"),D.textContent="🗑️",this.h()},l(e){t=E(e,"DIV",{class:!0});var r=T(t);s=E(r,"DIV",{class:!0});var u=T(s);n=$(u,L),i=$(u," - "),a=$(u,B),u.forEach(f),o=x(r),l=E(r,"H4",{class:!0});var d=T(l);c=$(d,M),h=x(d),W&&W.l(d),d.forEach(f),p=x(r),z&&z.l(r),r.forEach(f),y=x(e),_=E(e,"DIV",{class:!0});var g=T(_);S=E(g,"DIV",{class:!0});var v=T(S);A=$(v,V),v.forEach(f),I=x(g),P=E(g,"DIV",{class:!0});var m=T(P);F&&F.l(m),O=x(m),C=E(m,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),"svelte-mqn5ya"!==k(C)&&(C.textContent="✏️"),R=x(m),D=E(m,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1i89nl0"!==k(D)&&(D.textContent="🗑️"),m.forEach(f),g.forEach(f),this.h()},h(){w(s,"class","worklog-time svelte-59k27k"),w(l,"class","worklog-title svelte-59k27k"),w(t,"class","worklog-main svelte-59k27k"),w(S,"class","worklog-duration svelte-59k27k"),w(C,"class","edit-btn svelte-59k27k"),w(C,"title","Edit worklog"),w(D,"class","delete-btn svelte-59k27k"),w(P,"class","worklog-actions svelte-59k27k"),w(_,"class","worklog-meta svelte-59k27k")},m(e,r){d(e,t,r),u(t,s),u(s,n),u(s,i),u(s,a),u(t,o),u(t,l),u(l,c),u(l,h),W&&W.m(l,null),u(t,p),z&&z.m(t,null),d(e,y,r),d(e,_,r),u(_,S),u(S,A),u(_,I),u(_,P),F&&F.m(P,null),u(P,O),u(P,C),u(P,R),u(P,D),U||(N=[b(C,"click",H),b(D,"click",K)],U=!0)},p(s,r){e=s,4&r[0]&&L!==(L=Xn(e[58].start_time)+"")&&j(n,L),4&r[0]&&B!==(B=Xn(e[58].end_time)+"")&&j(a,B),4&r[0]&&M!==(M=e[58].title+"")&&j(c,M),4&r[0]&&(q=Yn(e[58].title)),q?W||(W=Mn(),W.c(),W.m(l,null)):W&&(W.d(1),W=null),e[58].description?z?z.p(e,r):(z=qn(e),z.c(),z.m(t,null)):z&&(z.d(1),z=null),4&r[0]&&V!==(V=Qn(e[58].duration)+"")&&j(A,V),4&r[0]&&(J=Yn(e[58].title)&&e[21]()),J?F?F.p(e,r):(F=Vn(e),F.c(),F.m(P,O)):F&&(F.d(1),F=null)},d(e){e&&(f(t),f(y),f(_)),W&&W.d(),z&&z.d(),F&&F.d(),U=!1,r(N)}}}function Bn(e){let t,s,n,i,a,o,l,c,h,p,y,S,I,P,O,C,R,D,U,N,L,B,M,q,V="Duration (minutes)",J=e[10]?"Saving...":"Save",W=e[18]&&Jn(),z=e[17]&&e[16].length>0&&Wn(e);return{c(){t=g("div"),s=g("div"),n=g("div"),i=g("input"),a=m(),W&&W.c(),o=m(),z&&z.c(),l=m(),c=g("textarea"),h=m(),p=g("div"),y=g("div"),S=g("label"),S.textContent=V,I=m(),P=g("input"),O=m(),C=g("div"),R=g("button"),D=v("Cancel"),U=m(),N=g("button"),L=v(J),this.h()},l(e){t=E(e,"DIV",{class:!0});var r=T(t);s=E(r,"DIV",{class:!0});var u=T(s);n=E(u,"DIV",{class:!0});var d=T(n);i=E(d,"INPUT",{placeholder:!0,class:!0,maxlength:!0}),a=x(d),W&&W.l(d),o=x(d),z&&z.l(d),d.forEach(f),l=x(u),c=E(u,"TEXTAREA",{placeholder:!0,class:!0,maxlength:!0}),T(c).forEach(f),h=x(u),p=E(u,"DIV",{class:!0});var g=T(p);y=E(g,"DIV",{class:!0});var v=T(y);S=E(v,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-1hornec"!==k(S)&&(S.textContent=V),I=x(v),P=E(v,"INPUT",{type:!0,min:!0,max:!0,class:!0}),v.forEach(f),O=x(g),C=E(g,"DIV",{class:!0});var m=T(C);R=E(m,"BUTTON",{class:!0});var b=T(R);D=$(b,"Cancel"),b.forEach(f),U=x(m),N=E(m,"BUTTON",{class:!0});var w=T(N);L=$(w,J),w.forEach(f),m.forEach(f),g.forEach(f),u.forEach(f),r.forEach(f),this.h()},h(){w(i,"placeholder","Issue key (SUP-165) or description..."),w(i,"class","worklog-input svelte-59k27k"),i.disabled=e[10],w(i,"maxlength","200"),w(n,"class","title-input-container svelte-59k27k"),w(c,"placeholder","Details (optional)..."),w(c,"class","worklog-textarea svelte-59k27k"),c.disabled=e[10],w(c,"maxlength","500"),w(S,"class","svelte-59k27k"),w(P,"type","number"),w(P,"min","1"),w(P,"max","480"),w(P,"class","duration-field svelte-59k27k"),P.disabled=e[10],w(y,"class","duration-input svelte-59k27k"),w(R,"class","cancel-btn svelte-59k27k"),R.disabled=e[10],w(N,"class","save-btn svelte-59k27k"),N.disabled=B=e[10]||!e[9].title.trim(),w(C,"class","edit-actions svelte-59k27k"),w(p,"class","duration-row svelte-59k27k"),w(s,"class","edit-form svelte-59k27k"),w(t,"class","worklog-edit svelte-59k27k")},m(r,f){d(r,t,f),u(t,s),u(s,n),u(n,i),A(i,e[9].title),u(n,a),W&&W.m(n,null),u(n,o),z&&z.m(n,null),u(s,l),u(s,c),A(c,e[9].description),u(s,h),u(s,p),u(p,y),u(y,S),u(y,I),u(y,P),A(P,e[9].duration),u(p,O),u(p,C),u(C,R),u(R,D),u(C,U),u(C,N),u(N,L),M||(q=[b(i,"input",e[42]),b(i,"input",e[23]),b(i,"blur",e[27]),b(c,"input",e[44]),b(P,"input",e[45]),b(R,"click",e[30]),b(N,"click",e[31])],M=!0)},p(e,t){1024&t[0]&&(i.disabled=e[10]),512&t[0]&&i.value!==e[9].title&&A(i,e[9].title),e[18]?W||(W=Jn(),W.c(),W.m(n,o)):W&&(W.d(1),W=null),e[17]&&e[16].length>0?z?z.p(e,t):(z=Wn(e),z.c(),z.m(n,null)):z&&(z.d(1),z=null),1024&t[0]&&(c.disabled=e[10]),512&t[0]&&A(c,e[9].description),1024&t[0]&&(P.disabled=e[10]),512&t[0]&&_(P.value)!==e[9].duration&&A(P,e[9].duration),1024&t[0]&&(R.disabled=e[10]),1024&t[0]&&J!==(J=e[10]?"Saving...":"Save")&&j(L,J),1536&t[0]&&B!==(B=e[10]||!e[9].title.trim())&&(N.disabled=B)},d(e){e&&f(t),W&&W.d(),z&&z.d(),M=!1,r(q)}}}function Mn(e){let t,s="JIRA";return{c(){t=g("span"),t.textContent=s,this.h()},l(e){t=E(e,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1y8n9hz"!==k(t)&&(t.textContent=s),this.h()},h(){w(t,"class","jira-badge svelte-59k27k")},m(e,s){d(e,t,s)},d(e){e&&f(t)}}}function qn(e){let t,s,r=e[58].description+"";return{c(){t=g("p"),s=v(r),this.h()},l(e){t=E(e,"P",{class:!0});var n=T(t);s=$(n,r),n.forEach(f),this.h()},h(){w(t,"class","worklog-desc svelte-59k27k")},m(e,r){d(e,t,r),u(t,s)},p(e,t){4&t[0]&&r!==(r=e[58].description+"")&&j(s,r)},d(e){e&&f(t)}}}function Vn(e){let t,s,r,n,i,a,o=e[15][e[58].id]?"⏳":"🚀";function l(){return e[46](e[58])}return{c(){t=g("button"),s=v(o),r=v(" Jira"),this.h()},l(e){t=E(e,"BUTTON",{class:!0});var n=T(t);s=$(n,o),r=$(n," Jira"),n.forEach(f),this.h()},h(){w(t,"class","jira-btn svelte-59k27k"),t.disabled=n=e[15][e[58].id]},m(e,n){d(e,t,n),u(t,s),u(t,r),i||(a=b(t,"click",l),i=!0)},p(r,i){e=r,32772&i[0]&&o!==(o=e[15][e[58].id]?"⏳":"🚀")&&j(s,o),32772&i[0]&&n!==(n=e[15][e[58].id])&&(t.disabled=n)},d(e){e&&f(t),i=!1,a()}}}function Jn(e){let t;return{c(){t=g("div"),t.textContent="🔍",this.h()},l(e){t=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-vq0d55"!==k(t)&&(t.textContent="🔍"),this.h()},h(){w(t,"class","search-indicator svelte-59k27k")},m(e,s){d(e,t,s)},d(e){e&&f(t)}}}function Wn(e){let t,s=Z(e[16]),r=[];for(let t=0;t<s.length;t+=1)r[t]=zn(In(e,s,t));return{c(){t=g("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){t=E(e,"DIV",{class:!0});var s=T(t);for(let e=0;e<r.length;e+=1)r[e].l(s);s.forEach(f),this.h()},h(){w(t,"class","suggestions-dropdown svelte-59k27k")},m(e,s){d(e,t,s);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)},p(e,n){if(33619968&n[0]){let i;for(s=Z(e[16]),i=0;i<s.length;i+=1){const a=In(e,s,i);r[i]?r[i].p(a,n):(r[i]=zn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=s.length}},d(e){e&&f(t),p(r,e)}}}function zn(e){let t,s,r,n,i,a,o,l,c=e[61].key+"",h=e[61].summary+"";function p(){return e[43](e[61])}return{c(){t=g("div"),s=g("strong"),r=v(c),n=v(" — "),i=v(h),a=m(),this.h()},l(e){t=E(e,"DIV",{class:!0});var o=T(t);s=E(o,"STRONG",{class:!0});var l=T(s);r=$(l,c),l.forEach(f),n=$(o," — "),i=$(o,h),a=x(o),o.forEach(f),this.h()},h(){w(s,"class","svelte-59k27k"),w(t,"class","suggestion-item svelte-59k27k")},m(e,c){d(e,t,c),u(t,s),u(s,r),u(t,n),u(t,i),u(t,a),o||(l=b(t,"mousedown",p),o=!0)},p(t,s){e=t,65536&s[0]&&c!==(c=e[61].key+"")&&j(r,c),65536&s[0]&&h!==(h=e[61].summary+"")&&j(i,h)},d(e){e&&f(t),o=!1,l()}}}function Fn(e,t){let s,r;function n(e,t){return e[8]===e[58].id?Bn:Ln}let i=n(t),a=i(t);return{key:e,first:null,c(){s=g("div"),a.c(),r=m(),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);a.l(t),r=x(t),t.forEach(f),this.h()},h(){w(s,"class","worklog-item svelte-59k27k"),this.first=s},m(e,t){d(e,s,t),a.m(s,null),u(s,r)},p(e,o){i===(i=n(t=e))&&a?a.p(t,o):(a.d(1),a=i(t),a&&(a.c(),a.m(s,r)))},d(e){e&&f(s),a.d()}}}function Hn(e){let t,s,n,i,a,o,l,c,h,p,v,y,_,S,$,j,I,P,O,C,R,D="🔧 Configure Jira Integration",U="Jira Base URL",N="Personal Access Token",L="Cancel",B="Save Configuration";return{c(){t=g("div"),s=g("div"),n=g("h3"),n.textContent=D,i=m(),a=g("div"),o=g("div"),l=g("label"),l.textContent=U,c=m(),h=g("input"),p=m(),v=g("div"),y=g("label"),y.textContent=N,_=m(),S=g("input"),$=m(),j=g("div"),I=g("button"),I.textContent=L,P=m(),O=g("button"),O.textContent=B,this.h()},l(e){t=E(e,"DIV",{class:!0});var r=T(t);s=E(r,"DIV",{class:!0});var u=T(s);n=E(u,"H3",{class:!0,"data-svelte-h":!0}),"svelte-x1y6ik"!==k(n)&&(n.textContent=D),i=x(u),a=E(u,"DIV",{class:!0});var d=T(a);o=E(d,"DIV",{class:!0});var g=T(o);l=E(g,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-5ekurs"!==k(l)&&(l.textContent=U),c=x(g),h=E(g,"INPUT",{placeholder:!0,class:!0,type:!0}),g.forEach(f),p=x(d),v=E(d,"DIV",{class:!0});var m=T(v);y=E(m,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-1ftcjxb"!==k(y)&&(y.textContent=N),_=x(m),S=E(m,"INPUT",{placeholder:!0,class:!0,type:!0}),m.forEach(f),$=x(d),j=E(d,"DIV",{class:!0});var b=T(j);I=E(b,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1yhkecp"!==k(I)&&(I.textContent=L),P=x(b),O=E(b,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-11yzilf"!==k(O)&&(O.textContent=B),b.forEach(f),d.forEach(f),u.forEach(f),r.forEach(f),this.h()},h(){w(n,"class","svelte-59k27k"),w(l,"class","svelte-59k27k"),w(h,"placeholder","https://jira.com"),w(h,"class","config-input svelte-59k27k"),w(h,"type","url"),w(o,"class","form-group svelte-59k27k"),w(y,"class","svelte-59k27k"),w(S,"placeholder","Your Jira API token"),w(S,"class","config-input svelte-59k27k"),w(S,"type","password"),w(v,"class","form-group svelte-59k27k"),w(I,"class","cancel-btn svelte-59k27k"),w(O,"class","save-btn svelte-59k27k"),w(j,"class","config-actions svelte-59k27k"),w(a,"class","config-form svelte-59k27k"),w(s,"class","modal-content svelte-59k27k"),w(t,"class","modal-overlay svelte-59k27k")},m(r,f){var g;d(r,t,f),u(t,s),u(s,n),u(s,i),u(s,a),u(a,o),u(o,l),u(o,c),u(o,h),A(h,e[1].baseUrl),u(a,p),u(a,v),u(v,y),u(v,_),u(v,S),A(S,e[1].token),u(a,$),u(a,j),u(j,I),u(j,P),u(j,O),C||(R=[b(h,"input",e[49]),b(S,"input",e[50]),b(I,"click",e[51]),b(O,"click",e[20]),b(s,"click",(g=e[34],function(e){return e.stopPropagation(),g.call(this,e)})),b(t,"click",e[52])],C=!0)},p(e,t){2&t[0]&&h.value!==e[1].baseUrl&&A(h,e[1].baseUrl),2&t[0]&&S.value!==e[1].token&&A(S,e[1].token)},d(e){e&&f(t),C=!1,r(R)}}}function Kn(t){let s,n,i,a,o,l,c,h,p,S,I,O,C,R,D,U,N,L,B,M,q,V,J,W,z,F,H,K,G,Y,X,Q,Z,ee,te,se,re,ne,ie,ae,oe,le,ce,he,ue,de,fe,pe,ge,ve,me,ye,be,we=t[21]()?"🔗 Jira Connected":"⚙️ Configure Jira",ke=t[2].length+"",_e="Sessions",Te=Zn(t[4])+"",Se="Total Time",Ee="＋ Add Manual Entry",$e="Duration (minutes)",xe=t[6]?"Brewing...":"Add Log",je=t[12]&&On(),Ae=t[14]&&t[13].length>0&&Cn(t);function Ie(e,t){return e[3]?Nn:0===e[2].length?Un:Dn}let Pe=Ie(t),Oe=Pe(t),Ce=t[11]&&Hn(t);return{c(){s=g("div"),n=g("div"),i=g("div"),a=g("div"),o=g("span"),o.textContent="📅",l=m(),c=g("input"),h=m(),p=g("button"),S=v(we),I=m(),O=g("div"),C=g("div"),R=g("div"),R.textContent="🍵",D=m(),U=g("div"),N=v(ke),L=m(),B=g("div"),B.textContent=_e,M=m(),q=g("div"),V=g("div"),V.textContent="⏱️",J=m(),W=g("div"),z=v(Te),F=m(),H=g("div"),H.textContent=Se,K=m(),G=g("div"),Y=g("h3"),Y.textContent=Ee,X=m(),Q=g("div"),Z=g("div"),ee=g("input"),te=m(),je&&je.c(),se=m(),Ae&&Ae.c(),re=m(),ne=g("textarea"),ie=m(),ae=g("div"),oe=g("div"),le=g("label"),le.textContent=$e,ce=m(),he=g("input"),ue=m(),de=g("button"),fe=v(xe),ge=m(),Oe.c(),ve=m(),Ce&&Ce.c(),me=y(),this.h()},l(e){s=E(e,"DIV",{class:!0});var t=T(s);n=E(t,"DIV",{class:!0});var r=T(n);i=E(r,"DIV",{class:!0});var u=T(i);a=E(u,"DIV",{class:!0});var d=T(a);o=E(d,"SPAN",{class:!0,"data-svelte-h":!0}),"svelte-1giqp3j"!==k(o)&&(o.textContent="📅"),l=x(d),c=E(d,"INPUT",{type:!0,class:!0,max:!0}),d.forEach(f),h=x(u),p=E(u,"BUTTON",{class:!0});var g=T(p);S=$(g,we),g.forEach(f),u.forEach(f),r.forEach(f),I=x(t),O=E(t,"DIV",{class:!0});var v=T(O);C=E(v,"DIV",{class:!0});var m=T(C);R=E(m,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-j4xmj0"!==k(R)&&(R.textContent="🍵"),D=x(m),U=E(m,"DIV",{class:!0});var b=T(U);N=$(b,ke),b.forEach(f),L=x(m),B=E(m,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-oyyft3"!==k(B)&&(B.textContent=_e),m.forEach(f),M=x(v),q=E(v,"DIV",{class:!0});var w=T(q);V=E(w,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1tmwwct"!==k(V)&&(V.textContent="⏱️"),J=x(w),W=E(w,"DIV",{class:!0});var _=T(W);z=$(_,Te),_.forEach(f),F=x(w),H=E(w,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1txvltl"!==k(H)&&(H.textContent=Se),w.forEach(f),v.forEach(f),K=x(t),G=E(t,"DIV",{class:!0});var j=T(G);Y=E(j,"H3",{class:!0,"data-svelte-h":!0}),"svelte-17w7ti4"!==k(Y)&&(Y.textContent=Ee),X=x(j),Q=E(j,"DIV",{class:!0});var A=T(Q);Z=E(A,"DIV",{class:!0});var P=T(Z);ee=E(P,"INPUT",{placeholder:!0,class:!0,maxlength:!0}),te=x(P),je&&je.l(P),se=x(P),Ae&&Ae.l(P),P.forEach(f),re=x(A),ne=E(A,"TEXTAREA",{placeholder:!0,class:!0,maxlength:!0}),T(ne).forEach(f),ie=x(A),ae=E(A,"DIV",{class:!0});var pe=T(ae);oe=E(pe,"DIV",{class:!0});var ye=T(oe);le=E(ye,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-1hornec"!==k(le)&&(le.textContent=$e),ce=x(ye),he=E(ye,"INPUT",{type:!0,min:!0,max:!0,class:!0}),ye.forEach(f),ue=x(pe),de=E(pe,"BUTTON",{class:!0});var be=T(de);fe=$(be,xe),be.forEach(f),pe.forEach(f),A.forEach(f),j.forEach(f),ge=x(t),Oe.l(t),t.forEach(f),ve=x(e),Ce&&Ce.l(e),me=y(),this.h()},h(){w(o,"class","calendar-icon svelte-59k27k"),w(c,"type","date"),w(c,"class","date-input svelte-59k27k"),w(c,"max",(new Date).toISOString().split("T")[0]),w(a,"class","date-input-wrapper svelte-59k27k"),w(p,"class","config-btn svelte-59k27k"),P(p,"configured",t[21]()),w(i,"class","header-actions svelte-59k27k"),w(n,"class","worklogs-header svelte-59k27k"),w(R,"class","stat-icon svelte-59k27k"),w(U,"class","stat-value svelte-59k27k"),w(B,"class","stat-label svelte-59k27k"),w(C,"class","stat-card svelte-59k27k"),w(V,"class","stat-icon svelte-59k27k"),w(W,"class","stat-value svelte-59k27k"),w(H,"class","stat-label svelte-59k27k"),w(q,"class","stat-card accent svelte-59k27k"),w(O,"class","stats-cards svelte-59k27k"),w(Y,"class","svelte-59k27k"),w(ee,"placeholder","Issue key (SUP-165) or description..."),w(ee,"class","worklog-input svelte-59k27k"),ee.disabled=t[6],w(ee,"maxlength","200"),w(Z,"class","title-input-container svelte-59k27k"),w(ne,"placeholder","Details (optional)..."),w(ne,"class","worklog-textarea svelte-59k27k"),ne.disabled=t[6],w(ne,"maxlength","500"),w(le,"class","svelte-59k27k"),w(he,"type","number"),w(he,"min","1"),w(he,"max","480"),w(he,"class","duration-field svelte-59k27k"),he.disabled=t[6],w(oe,"class","duration-input svelte-59k27k"),w(de,"class","add-btn svelte-59k27k"),de.disabled=pe=t[6]||!t[5].title.trim(),w(ae,"class","duration-row svelte-59k27k"),w(Q,"class","add-form svelte-59k27k"),w(G,"class","add-worklog svelte-59k27k"),w(s,"class","worklogs-container svelte-59k27k")},m(e,r){d(e,s,r),u(s,n),u(n,i),u(i,a),u(a,o),u(a,l),u(a,c),A(c,t[0]),t[36](c),u(i,h),u(i,p),u(p,S),u(s,I),u(s,O),u(O,C),u(C,R),u(C,D),u(C,U),u(U,N),u(C,L),u(C,B),u(O,M),u(O,q),u(q,V),u(q,J),u(q,W),u(W,z),u(q,F),u(q,H),u(s,K),u(s,G),u(G,Y),u(G,X),u(G,Q),u(Q,Z),u(Z,ee),A(ee,t[5].title),u(Z,te),je&&je.m(Z,null),u(Z,se),Ae&&Ae.m(Z,null),u(Q,re),u(Q,ne),A(ne,t[5].description),u(Q,ie),u(Q,ae),u(ae,oe),u(oe,le),u(oe,ce),u(oe,he),A(he,t[5].duration),u(ae,ue),u(ae,de),u(de,fe),u(s,ge),Oe.m(s,null),d(e,ve,r),Ce&&Ce.m(e,r),d(e,me,r),ye||(be=[b(c,"input",t[35]),b(a,"click",t[19]),b(p,"click",t[37]),b(ee,"input",t[38]),b(ee,"input",t[22]),b(ee,"blur",t[26]),b(ne,"input",t[40]),b(he,"input",t[41]),b(de,"click",t[32])],ye=!0)},p(e,t){1&t[0]&&A(c,e[0]),4&t[0]&&ke!==(ke=e[2].length+"")&&j(N,ke),16&t[0]&&Te!==(Te=Zn(e[4])+"")&&j(z,Te),64&t[0]&&(ee.disabled=e[6]),32&t[0]&&ee.value!==e[5].title&&A(ee,e[5].title),e[12]?je||(je=On(),je.c(),je.m(Z,se)):je&&(je.d(1),je=null),e[14]&&e[13].length>0?Ae?Ae.p(e,t):(Ae=Cn(e),Ae.c(),Ae.m(Z,null)):Ae&&(Ae.d(1),Ae=null),64&t[0]&&(ne.disabled=e[6]),32&t[0]&&A(ne,e[5].description),64&t[0]&&(he.disabled=e[6]),32&t[0]&&_(he.value)!==e[5].duration&&A(he,e[5].duration),64&t[0]&&xe!==(xe=e[6]?"Brewing...":"Add Log")&&j(fe,xe),96&t[0]&&pe!==(pe=e[6]||!e[5].title.trim())&&(de.disabled=pe),Pe===(Pe=Ie(e))&&Oe?Oe.p(e,t):(Oe.d(1),Oe=Pe(e),Oe&&(Oe.c(),Oe.m(s,null))),e[11]?Ce?Ce.p(e,t):(Ce=Hn(e),Ce.c(),Ce.m(me.parentNode,me)):Ce&&(Ce.d(1),Ce=null)},i:e,o:e,d(e){e&&(f(s),f(ve),f(me)),t[36](null),je&&je.d(),Ae&&Ae.d(),Oe.d(),Ce&&Ce.d(e),ye=!1,r(be)}}}function Gn(e){return encodeURIComponent(e)}function Yn(e){return/^[A-Z][A-Z0-9]*-\d+$/i.test(e.trim())}function Xn(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function Qn(e){const t=Math.floor(e/3600),s=Math.floor(e%3600/60);return t>0?`${t}h ${s}m`:`${s}m`}function Zn(e){const t=Math.floor(e/3600),s=Math.floor(e%3600/60);return t>0?`${t} hour${t>1?"s":""} ${s} minute${1!==s?"s":""}`:`${s} minute${1!==s?"s":""}`}function ei(e,t,s){let r,n=[],i=(new Date).toISOString().split("T")[0],a=!1,o=0,l={title:"",description:"",duration:30},c=!1;let h,u,d=null,f={title:"",description:"",duration:30},p=!1,g=!1,v={baseUrl:"",token:""},m=!1,y=[],b=!1,w={},k=[],T=!1,S=!1;function E(){return v.baseUrl&&v.token}async function $(e,t=!1){if(E()&&e.trim())try{t?s(18,S=!0):s(12,m=!0);const r=e.trim();let n;if(Yn(r))n=`${v.baseUrl}/rest/api/1.0/issues/picker?query=${Gn(r)}&showSubTasks=true`;else{const e=Gn(r);n=`${v.baseUrl}/rest/api/2/search?jql=summary~"${e}"&fields=key,summary&maxResults=10`}const i=await fetch(n,{headers:{Authorization:`Bearer ${v.token}`,Accept:"application/json","X-Atlassian-Token":"nocheck"}});if(!i.ok)throw new Error(`Jira API error: ${i.status}`);const a=await i.json();let o=[];Yn(r)?a.sections&&a.sections.forEach(e=>{e.issues&&o.push(...e.issues.map(e=>({key:e.key,summary:e.summaryText||e.summary})))}):o=a.issues?a.issues.map(e=>({key:e.key,summary:e.fields.summary})):[],t?(s(16,k=o),s(17,T=o.length>0)):(s(13,y=o),s(14,b=o.length>0))}catch(e){console.error("Jira search error:",e),t?(s(16,k=[]),s(17,T=!1)):(s(13,y=[]),s(14,b=!1))}finally{t?s(18,S=!1):s(12,m=!1)}else t?s(16,k=[]):s(13,y=[])}function x(e){s(5,l.title=e.key,l),s(13,y=[]),s(14,b=!1)}function j(e){s(9,f.title=e.key,f),s(16,k=[]),s(17,T=!1)}async function A(e){if(E())if(Yn(e.title))try{s(15,w[e.id]=!0,w);const t=new Date(i),r=new Date(e.start_time);t.setHours(r.getHours(),r.getMinutes(),r.getSeconds());const n=t.toISOString().replace("Z","+0000"),a={comment:e.description||e.title,started:n,timeSpentSeconds:e.duration},o=await fetch(`${v.baseUrl}/rest/api/2/issue/${e.title}/worklog`,{method:"POST",headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"application/json","User-Agent":"test-agent","X-Atlassian-Token":"no-check",Origin:`${v.baseUrl}`,"Sec-Fetch-Site":"same-origin","X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(a)});if(!o.ok){const e=await o.text();throw new Error(`Jira API error: ${o.status} - ${e}`)}Hr(`✅ Pushed to Jira: ${e.title} (${i})`)}catch(e){console.error("Error pushing to Jira:",e),Kr(`Failed to push to Jira: ${e.message}`)}finally{s(15,w[e.id]=!1,w)}else Kr("Cannot push to Jira: Invalid issue key format");else Kr("Please configure Jira first")}function I(e){s(8,d=e.id),s(9,f={title:e.title,description:e.description||"",duration:Math.round(e.duration/60)}),s(16,k=[]),s(17,T=!1)}function P(){s(8,d=null),s(9,f={title:"",description:"",duration:30}),s(16,k=[]),s(17,T=!1)}async function O(){try{s(3,a=!0);const e=await Br();if(!e)return;const{data:t,error:r}=await Lr.from("worklogs").select("*").eq("user_id",e.id).eq("date",i).order("start_time",{ascending:!1});if(r)throw r;s(2,n=t||[]),s(4,o=n.reduce((e,t)=>e+t.duration,0))}catch(e){console.error("Error fetching worklogs:",e),Kr("Failed to load worklogs")}finally{s(3,a=!1)}}async function C(e){if(confirm("Are you sure you want to delete this worklog?"))try{const{error:t}=await Lr.from("worklogs").delete().eq("id",e);if(t)throw t;const r=n.find(t=>t.id===e);r&&s(4,o-=r.duration),s(2,n=n.filter(t=>t.id!==e)),d===e&&P(),Hr("🗑️ Worklog deleted")}catch(e){console.error("Error deleting worklog:",e),Kr("Failed to delete worklog")}}R(()=>{!function(){const e=localStorage.getItem("jiraConfig");if(e)try{s(1,v=JSON.parse(e))}catch(e){console.error("Error loading Jira config:",e)}}(),O()});return e.$$.update=()=>{if(2&e.$$.dirty[0]&&v?.baseUrl&&window.electron?.sendOrigin)try{const e=new URL(v.baseUrl),t=`${e.protocol}//${e.hostname}`;window.electron.sendOrigin(t)}catch(e){console.error("Invalid Jira URL:",v.baseUrl)}1&e.$$.dirty[0]&&i&&O()},[i,v,n,a,o,l,c,r,d,f,p,g,m,y,b,w,k,T,S,function(){r&&r.showPicker&&r.showPicker()},function(){v.baseUrl.trim()&&v.token.trim()?(s(1,v.baseUrl=v.baseUrl.trim().replace(/\/$/,""),v),localStorage.setItem("jiraConfig",JSON.stringify(v)),s(11,g=!1),Hr("🔧 Jira configuration saved!")):Kr("Please enter both Jira URL and token")},E,function(e){const t=e.target.value;if(s(5,l.title=t,l),h&&clearTimeout(h),t.length<2)return s(13,y=[]),void s(14,b=!1);h=setTimeout(()=>{$(t)},300)},function(e){const t=e.target.value;if(s(9,f.title=t,f),u&&clearTimeout(u),t.length<2)return s(16,k=[]),void s(17,T=!1);u=setTimeout(()=>{$(t,!0)},300)},x,j,function(){setTimeout(()=>{s(14,b=!1)},200)},function(){setTimeout(()=>{s(17,T=!1)},200)},A,I,P,async function(){if(f.title.trim())if(f.duration<1||f.duration>480)Kr("Duration must be between 1 and 480 minutes");else try{s(10,p=!0);const e=await Br();if(!e)return;const t=n.find(e=>e.id===d);if(!t)return;const r=new Date(t.end_time),i=new Date(r);i.setMinutes(i.getMinutes()-f.duration);const{data:a,error:l}=await Lr.from("worklogs").update({title:f.title.trim(),description:f.description.trim(),duration:60*f.duration,start_time:i.toISOString()}).eq("id",d).eq("user_id",e.id).select();if(l)throw l;if(a&&a[0]){const e=n.findIndex(e=>e.id===d);-1!==e&&(s(4,o=o-t.duration+a[0].duration),s(2,n[e]=a[0],n),s(2,n=[...n]))}P(),Hr("✅ Worklog updated successfully!")}catch(e){console.error("Error updating worklog:",e),Kr("Failed to update worklog")}finally{s(10,p=!1)}else Kr("Please enter a title")},async function(){if(l.title.trim())if(l.duration<1||l.duration>480)Kr("Duration must be between 1 and 480 minutes");else try{s(6,c=!0);const e=await Br();if(!e)return;const t=new Date,r=new Date(t);r.setMinutes(r.getMinutes()-l.duration);const{data:a,error:h}=await Lr.from("worklogs").insert({user_id:e.id,title:l.title.trim(),description:l.description.trim(),start_time:r.toISOString(),end_time:t.toISOString(),duration:60*l.duration,date:i}).select();if(h)throw h;a&&a[0]&&(s(2,n=[a[0],...n]),s(4,o+=a[0].duration)),s(5,l={title:"",description:"",duration:30}),s(13,y=[]),s(14,b=!1),Hr("✅ Worklog added successfully!")}catch(e){console.error("Error adding worklog:",e),Kr("Failed to add worklog")}finally{s(6,c=!1)}else Kr("Please enter a title")},C,function(t){D.call(this,e,t)},function(){i=this.value,s(0,i)},function(e){N[e?"unshift":"push"](()=>{r=e,s(7,r)})},()=>s(11,g=!0),function(){l.title=this.value,s(5,l)},e=>x(e),function(){l.description=this.value,s(5,l)},function(){l.duration=_(this.value),s(5,l)},function(){f.title=this.value,s(9,f)},e=>j(e),function(){f.description=this.value,s(9,f)},function(){f.duration=_(this.value),s(9,f)},e=>A(e),e=>I(e),e=>C(e.id),function(){v.baseUrl=this.value,s(1,v)},function(){v.token=this.value,s(1,v)},()=>s(11,g=!1),()=>s(11,g=!1)]}class ti extends le{constructor(e){super(),oe(this,e,ei,Kn,i,{},null,[-1,-1,-1])}}function si(t){let s,r='<div class="radio-player svelte-83fl27"><iframe title="Live radio" src="https://radio.9craft.ir" allow="autoplay" class="svelte-83fl27"></iframe></div>';return{c(){s=g("div"),s.innerHTML=r,this.h()},l(e){s=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1ux4t9y"!==k(s)&&(s.innerHTML=r),this.h()},h(){w(s,"class","radio-container svelte-83fl27")},m(e,t){d(e,s,t)},p:e,i:e,o:e,d(e){e&&f(s)}}}class ri extends le{constructor(e){super(),oe(this,e,null,si,i,{})}}const{document:ni}=o;function ii(e,t,s){const r=e.slice();return r[16]=t[s],r}function ai(e){let t,s,r,n,i,a,o,l;return{c(){t=g("div"),s=g("span"),r=v("❌ "),n=v(e[4]),i=m(),a=g("button"),a.textContent="✕",this.h()},l(o){t=E(o,"DIV",{class:!0});var l=T(t);s=E(l,"SPAN",{});var c=T(s);r=$(c,"❌ "),n=$(c,e[4]),c.forEach(f),i=x(l),a=E(l,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1blrq96"!==k(a)&&(a.textContent="✕"),l.forEach(f),this.h()},h(){w(a,"class","close-btn svelte-10ftwxl"),w(t,"class","notification error-notification svelte-10ftwxl")},m(c,h){d(c,t,h),u(t,s),u(s,r),u(s,n),u(t,i),u(t,a),o||(l=b(a,"click",e[10]),o=!0)},p(e,t){16&t&&j(n,e[4])},d(e){e&&f(t),o=!1,l()}}}function oi(e){let t,s,r,n,i,a,o;return{c(){t=g("div"),s=g("span"),r=v(e[5]),n=m(),i=g("button"),i.textContent="✕",this.h()},l(a){t=E(a,"DIV",{class:!0});var o=T(t);s=E(o,"SPAN",{});var l=T(s);r=$(l,e[5]),l.forEach(f),n=x(o),i=E(o,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-17jkr29"!==k(i)&&(i.textContent="✕"),o.forEach(f),this.h()},h(){w(i,"class","close-btn svelte-10ftwxl"),w(t,"class","notification success-notification svelte-10ftwxl")},m(l,c){d(l,t,c),u(t,s),u(s,r),u(t,n),u(t,i),a||(o=b(i,"click",e[11]),a=!0)},p(e,t){32&t&&j(r,e[5])},d(e){e&&f(t),a=!1,o()}}}function li(e){let t,s,r,n,i,a,o,l,c,h,v,y,_,S,$='<span class="nav-icon svelte-10ftwxl">✖</span> <span class="svelte-10ftwxl">Sign Out</span>',j='<div class="coffee-foam"></div>',A=Z(e[8]),I=[];for(let t=0;t<A.length;t+=1)I[t]=ui(ii(e,A,t));const P=[gi,pi,fi,di],O=[];function C(e,t){return"pomodoro"===e[1]?0:"todos"===e[1]?1:"worklogs"===e[1]?2:"radio"===e[1]?3:-1}return~(h=C(e))&&(v=O[h]=P[h](e)),{c(){t=g("div"),s=g("div");for(let e=0;e<I.length;e+=1)I[e].c();r=m(),n=g("button"),n.innerHTML=$,i=m(),a=g("div"),o=g("header"),o.innerHTML=j,l=m(),c=g("div"),v&&v.c(),this.h()},l(e){t=E(e,"DIV",{class:!0});var h=T(t);s=E(h,"DIV",{class:!0});var u=T(s);for(let e=0;e<I.length;e+=1)I[e].l(u);r=x(u),n=E(u,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),"svelte-1vdc2ba"!==k(n)&&(n.innerHTML=$),u.forEach(f),i=x(h),a=E(h,"DIV",{class:!0});var d=T(a);o=E(d,"HEADER",{class:!0,"data-svelte-h":!0}),"svelte-1ijd0vb"!==k(o)&&(o.innerHTML=j),l=x(d),c=E(d,"DIV",{class:!0});var p=T(c);v&&v.l(p),p.forEach(f),d.forEach(f),h.forEach(f),this.h()},h(){w(n,"class","nav-btn sign-out-btn svelte-10ftwxl"),w(n,"title","Sign Out"),w(s,"class","cyber-nav svelte-10ftwxl"),w(o,"class","coffee-header"),w(c,"class","content-wrapper svelte-10ftwxl"),w(a,"class","main-content svelte-10ftwxl"),w(t,"class","app-layout svelte-10ftwxl")},m(f,p){d(f,t,p),u(t,s);for(let e=0;e<I.length;e+=1)I[e]&&I[e].m(s,null);u(s,r),u(s,n),u(t,i),u(t,a),u(a,o),u(a,l),u(a,c),~h&&O[h].m(c,null),y=!0,_||(S=b(n,"click",e[9]),_=!0)},p(e,t){if(4354&t){let n;for(A=Z(e[8]),n=0;n<A.length;n+=1){const i=ii(e,A,n);I[n]?I[n].p(i,t):(I[n]=ui(i),I[n].c(),I[n].m(s,r))}for(;n<I.length;n+=1)I[n].d(1);I.length=A.length}let n=h;h=C(e),h!==n&&(v&&(G(),Q(O[n],1,1,()=>{O[n]=null}),Y()),~h?(v=O[h],v||(v=O[h]=P[h](e),v.c()),X(v,1),v.m(c,null)):v=null)},i(e){y||(X(v),y=!0)},o(e){Q(v),y=!1},d(e){e&&f(t),p(I,e),~h&&O[h].d(),_=!1,S()}}}function ci(t){let s,r;return s=new Zr({}),{c(){se(s.$$.fragment)},l(e){re(s.$$.fragment,e)},m(e,t){ne(s,e,t),r=!0},p:e,i(e){r||(X(s.$$.fragment,e),r=!0)},o(e){Q(s.$$.fragment,e),r=!1},d(e){ie(s,e)}}}function hi(t){let s;return{c(){s=g("div"),s.innerHTML="",this.h()},l(e){s=E(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-mmy0rw"!==k(s)&&(s.innerHTML=""),this.h()},h(){w(s,"class","loading-screen")},m(e,t){d(e,s,t)},p:e,i:e,o:e,d(e){e&&f(s)}}}function ui(e){let t,s,r,n,i,a,o,l,c=e[16].icon+"",h=e[16].label+"";function p(){return e[13](e[16])}return{c(){t=g("button"),s=g("span"),r=v(c),n=m(),i=g("span"),a=v(h),this.h()},l(e){t=E(e,"BUTTON",{class:!0,title:!0});var o=T(t);s=E(o,"SPAN",{class:!0});var l=T(s);r=$(l,c),l.forEach(f),n=x(o),i=E(o,"SPAN",{class:!0});var u=T(i);a=$(u,h),u.forEach(f),o.forEach(f),this.h()},h(){w(s,"class","nav-icon svelte-10ftwxl"),w(i,"class","svelte-10ftwxl"),w(t,"class","nav-btn svelte-10ftwxl"),w(t,"title",e[16].label),P(t,"active",e[1]===e[16].id)},m(e,c){d(e,t,c),u(t,s),u(s,r),u(t,n),u(t,i),u(i,a),o||(l=b(t,"click",p),o=!0)},p(s,r){e=s,258&r&&P(t,"active",e[1]===e[16].id)},d(e){e&&f(t),o=!1,l()}}}function di(e){let t,s;return t=new ri({}),{c(){se(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){Q(t.$$.fragment,e),s=!1},d(e){ie(t,e)}}}function fi(e){let t,s;return t=new ti({}),{c(){se(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){Q(t.$$.fragment,e),s=!1},d(e){ie(t,e)}}}function pi(e){let t,s;return t=new jn({}),{c(){se(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){Q(t.$$.fragment,e),s=!1},d(e){ie(t,e)}}}function gi(e){let t,s;return t=new mn({}),{c(){se(t.$$.fragment)},l(e){re(t.$$.fragment,e)},m(e,r){ne(t,e,r),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){Q(t.$$.fragment,e),s=!1},d(e){ie(t,e)}}}function vi(e){let t,s,r,n,i,a,o,l,c,h,p=e[4]&&ai(e),v=e[5]&&oi(e);const y=[hi,ci,li],b=[];function k(e,t){return e[3]?0:e[2]?2:1}return a=k(e),o=b[a]=y[a](e),{c(){t=g("meta"),s=m(),r=g("main"),p&&p.c(),n=m(),v&&v.c(),i=m(),o.c(),l=m(),c=g("div"),this.h()},l(e){const a=function(e,t){const s=[];let r=0;for(const n of t.childNodes)if(8===n.nodeType){const t=n.textContent.trim();t===`HEAD_${e}_END`?(r-=1,s.push(n)):t===`HEAD_${e}_START`&&(r+=1,s.push(n))}else r>0&&s.push(n);return s}("svelte-1xnnnhf",ni.head);t=E(a,"META",{name:!0,content:!0}),a.forEach(f),s=x(e),r=E(e,"MAIN",{class:!0});var h=T(r);p&&p.l(h),n=x(h),v&&v.l(h),i=x(h),o.l(h),l=x(h),c=E(h,"DIV",{class:!0,style:!0}),T(c).forEach(f),h.forEach(f),this.h()},h(){ni.title="Pomoson",w(t,"name","description"),w(t,"content","Stay focused and productive"),w(c,"class","dynamic-background svelte-10ftwxl"),I(c,"background",e[6][e[0]]),I(c,"background-color",e[7][e[0]]),w(r,"class","app")},m(e,o){u(ni.head,t),d(e,s,o),d(e,r,o),p&&p.m(r,null),u(r,n),v&&v.m(r,null),u(r,i),b[a].m(r,null),u(r,l),u(r,c),h=!0},p(e,[t]){e[4]?p?p.p(e,t):(p=ai(e),p.c(),p.m(r,n)):p&&(p.d(1),p=null),e[5]?v?v.p(e,t):(v=oi(e),v.c(),v.m(r,i)):v&&(v.d(1),v=null);let s=a;a=k(e),a===s?b[a].p(e,t):(G(),Q(b[s],1,1,()=>{b[s]=null}),Y(),o=b[a],o?o.p(e,t):(o=b[a]=y[a](e),o.c()),X(o,1),o.m(r,l)),(!h||1&t)&&I(c,"background",e[6][e[0]]),(!h||1&t)&&I(c,"background-color",e[7][e[0]])},i(e){h||(X(o),h=!0)},o(e){Q(o),h=!1},d(e){e&&(f(s),f(r)),f(t),p&&p.d(),v&&v.d(),b[a].d()}}}function mi(e,t,s){let r;en.subscribe(e=>{s(0,r=e),document.documentElement.setAttribute("data-theme",e)});const n={Pomoson:"\n        radial-gradient(at 20% 30%, rgba(93, 71, 139, 0.12), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(51, 102, 153, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(242, 204, 143, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(10, 10, 10, 0.03), transparent 70%)",dracula:"\n        radial-gradient(at 30% 30%, rgba(189, 147, 249, 0.15), transparent 60%),\n        radial-gradient(at 70% 70%, rgba(255, 121, 198, 0.12), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(139, 233, 253, 0.08), transparent 60%)",gruvbox:"\n        radial-gradient(at 20% 30%, rgba(184, 129, 69, 0.15), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(168, 153, 132, 0.1), transparent 60%)",jungle:"\n        radial-gradient(at 25% 30%, rgba(106, 176, 76, 0.15), transparent 60%),\n        radial-gradient(at 75% 70%, rgba(34, 166, 179, 0.1), transparent 60%)",light:"\n        radial-gradient(at 20% 30%, rgba(142, 36, 170, 0.12), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(30, 136, 229, 0.1), transparent 60%)",mono:"\n        radial-gradient(at 20% 30%, rgba(150, 150, 150, 0.12), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(100, 100, 100, 0.1), transparent 60%)","yellow-gruvbox":"\n        radial-gradient(at 25% 25%, rgba(152, 151, 26, 0.12), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(184, 187, 38, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(121, 116, 14, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(40, 40, 40, 0.02), transparent 70%)","pink-acid":"\n        radial-gradient(at 20% 20%, rgba(249, 38, 114, 0.10), transparent 60%),\n        radial-gradient(at 80% 75%, rgba(166, 226, 46, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(253, 151, 31, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(39, 40, 34, 0.02), transparent 70%)","frosty-blue":"\n        radial-gradient(at 20% 25%, rgba(136, 192, 208, 0.10), transparent 60%),\n        radial-gradient(at 70% 70%, rgba(94, 129, 172, 0.10), transparent 60%),\n        radial-gradient(at 60% 30%, rgba(59, 66, 82, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(46, 52, 64, 0.02), transparent 70%)","warm-gruvbox":"\n        radial-gradient(at 20% 20%, rgba(152, 151, 26, 0.14), transparent 60%),\n        radial-gradient(at 80% 75%, rgba(184, 187, 38, 0.12), transparent 60%),\n        radial-gradient(at 50% 60%, rgba(121, 116, 14, 0.10), transparent 60%),\n        radial-gradient(at 40% 40%, rgba(60, 56, 54, 0.10), transparent 70%),\n        radial-gradient(at 65% 30%, rgba(146, 131, 116, 0.06), transparent 65%),\n        radial-gradient(at 50% 50%, rgba(40, 40, 40, 0.03), transparent 75%)","blue-purple-green":"\n        radial-gradient(at 25% 30%, rgba(97, 175, 239, 0.10), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(198, 120, 221, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(152, 195, 121, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(40, 44, 52, 0.02), transparent 70%)","neon-night":"\n        radial-gradient(at 10% 20%, rgba(255, 0, 153, 0.14), transparent 60%),\n        radial-gradient(at 90% 60%, rgba(0, 255, 255, 0.12), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(255, 255, 0, 0.06), transparent 60%),\n        radial-gradient(at 70% 30%, rgba(0, 0, 0, 0.06), transparent 70%)","solarized-teal":"\n        radial-gradient(at 15% 15%, rgba(0, 150, 199, 0.10), transparent 60%),\n        radial-gradient(at 70% 85%, rgba(0, 214, 170, 0.12), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(7, 54, 66, 0.08), transparent 70%),\n        radial-gradient(at 30% 60%, rgba(38, 139, 210, 0.06), transparent 65%)","mystical-purple":"\n        radial-gradient(at 20% 30%, rgba(93, 71, 139, 0.12), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(51, 102, 153, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(242, 204, 143, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(10, 10, 10, 0.03), transparent 70%)","sunset-sky":"\n        radial-gradient(at 10% 20%, rgba(255, 94, 87, 0.12), transparent 60%),\n        radial-gradient(at 80% 80%, rgba(255, 195, 113, 0.10), transparent 60%),\n        radial-gradient(at 60% 40%, rgba(255, 247, 174, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(50, 10, 30, 0.02), transparent 70%)",matrix:"\n        radial-gradient(at 20% 30%, rgba(0, 255, 0, 0.10), transparent 60%),\n        radial-gradient(at 80% 70%, rgba(0, 128, 0, 0.08), transparent 60%),\n        radial-gradient(at 50% 50%, rgba(0, 64, 0, 0.06), transparent 70%),\n        radial-gradient(at 70% 20%, rgba(10, 10, 10, 0.04), transparent 65%)"};let i="pomodoro",a=null,o=!0,l="",c="";Vr.subscribe(e=>s(2,a=e)),Jr.subscribe(e=>s(3,o=e)),Wr.subscribe(e=>s(4,l=e)),zr.subscribe(e=>s(5,c=e));const h=[{id:"pomodoro",label:"Pomodoro",icon:"⧖",component:mn},{id:"todos",label:"Tasks",icon:"✓",component:jn},{id:"worklogs",label:"WorkLogs",icon:"≣",component:ti},{id:"radio",label:"Radio",icon:"♫",component:ri}];function u(e){s(1,i=e)}R(()=>{Lr.auth.getSession().then(({data:{session:e}})=>{Vr.set(e),Jr.set(!1)});const{data:{subscription:e}}=Lr.auth.onAuthStateChange(async(e,t)=>{Vr.set(t),Jr.set(!1),"SIGNED_OUT"===e&&s(1,i="pomodoro")});return()=>{e?.unsubscribe()}});return[r,i,a,o,l,c,n,{Pomoson:"#1a1b26",dracula:"#282a36",gruvbox:"#282828",jungle:"#1e272e",light:"#f5f5f5",mono:"#111","yellow-gruvbox":"#1d2021","pink-acid":"#272822","frosty-blue":"#2e3440","warm-gruvbox":"#1d2021","blue-purple-green":"#282c34","neon-night":"#0f0c29","solarized-teal":"#073642","mystical-purple":"#1a1b26","sunset-sky":"#2c001e",matrix:"#0c0c0c"},h,async function(){confirm("Ready to close your productive session?")&&(Jr.set(!0),await Lr.auth.signOut())},function(){Wr.set("")},function(){zr.set("")},u,e=>u(e.id)]}return new class extends le{constructor(e){super(),oe(this,e,mi,vi,i,{})}}({target:document.getElementById("app"),props:{}})}();
//# sourceMappingURL=bundle.js.map
